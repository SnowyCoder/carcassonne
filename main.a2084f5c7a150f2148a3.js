!function(t){function e(e){for(var i,r,o=e[0],l=e[1],h=e[2],c=0,p=[];c<o.length;c++)r=o[c],Object.prototype.hasOwnProperty.call(a,r)&&a[r]&&p.push(a[r][0]),a[r]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(t[i]=l[i]);for(d&&d(e);p.length;)p.shift()();return s.push.apply(s,h||[]),n()}function n(){for(var t,e=0;e<s.length;e++){for(var n=s[e],i=!0,o=1;o<n.length;o++){var l=n[o];0!==a[l]&&(i=!1)}i&&(s.splice(e--,1),t=r(r.s=n[0]))}return t}var i={},a={0:0},s=[];function r(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=i,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="";var o=window.webpackJsonp=window.webpackJsonp||[],l=o.push.bind(o);o.push=e,o=o.slice();for(var h=0;h<o.length;h++)e(o[h]);var d=l;s.push([72,1]),n()}([,,,,,,,,,,,,function(t,e,n){var i=n(43);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,n(4).default)("4c8a91d5",i,!1,{})},function(t,e,n){var i=n(45);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,n(4).default)("09cad008",i,!1,{})},function(t,e,n){var i=n(47);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,n(4).default)("73dd56e0",i,!1,{})},function(t,e,n){var i=n(49);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,n(4).default)("7c681468",i,!1,{})},function(t,e,n){var i=n(53);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,n(4).default)("99677694",i,!1,{})},function(t,e,n){var i=n(55);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,n(4).default)("5b2973ba",i,!1,{})},function(t,e,n){var i=n(57);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,n(4).default)("390a1ab5",i,!1,{})},function(t,e,n){var i=n(59);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,n(4).default)("7cff4ca6",i,!1,{})},function(t,e,n){var i=n(61);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,n(4).default)("13fd08f0",i,!1,{})},function(t,e,n){var i=n(63);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,n(4).default)("6982b30c",i,!1,{})},function(t,e,n){var i=n(65);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,n(4).default)("c31f298e",i,!1,{})},function(t,e,n){var i=n(67);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,n(4).default)("40e34d44",i,!1,{})},function(t,e,n){var i=n(69);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,n(4).default)("83bf1d5a",i,!1,{})},,,,function(t){t.exports=JSON.parse('[{"spritePath":"image--000.png","quantity":4,"sides":{"top":"lawn","right":"lawn","bottom":"lawn","left":"lawn"},"connections":[],"flags":["monastery"]},{"spritePath":"image--001.png","quantity":2,"sides":{"top":"lawn","right":"lawn","bottom":"road","left":"lawn"},"connections":[],"flags":["monastery"]},{"spritePath":"image--002.png","quantity":2,"sides":{"top":"village","right":"village","bottom":"village","left":"village"},"connections":[[0,1,2,3]],"flags":["pennant"]},{"spritePath":"image--003.png","quantity":3,"sides":{"top":"village","right":"village","bottom":"lawn","left":"village"},"connections":[[0,1,3]],"flags":[]},{"spritePath":"image--004.png","quantity":1,"sides":{"top":"village","right":"village","bottom":"lawn","left":"village"},"connections":[[0,1,3]],"flags":["pennant"]},{"spritePath":"image--005.png","quantity":1,"sides":{"top":"village","right":"village","bottom":"road","left":"village"},"connections":[[0,1,3]],"flags":[]},{"spritePath":"image--006.png","quantity":2,"sides":{"top":"village","right":"village","bottom":"road","left":"village"},"connections":[[0,1,3]],"flags":["pennant"]},{"spritePath":"image--007.png","quantity":3,"sides":{"top":"village","right":"lawn","bottom":"lawn","left":"village"},"connections":[[0,3]],"flags":[]},{"spritePath":"image--008.png","quantity":2,"sides":{"top":"village","right":"lawn","bottom":"lawn","left":"village"},"connections":[[0,3]],"flags":["pennant"]},{"spritePath":"image--009.png","quantity":3,"sides":{"top":"village","right":"road","bottom":"road","left":"village"},"connections":[[0,3],[1,2]],"flags":[]},{"spritePath":"image--010.png","quantity":2,"sides":{"top":"village","right":"road","bottom":"road","left":"village"},"connections":[[0,3],[1,2]],"flags":["pennant"]},{"spritePath":"image--011.png","quantity":1,"sides":{"top":"lawn","right":"village","bottom":"lawn","left":"village"},"connections":[[1,3]],"flags":[]},{"spritePath":"image--012.png","quantity":2,"sides":{"top":"lawn","right":"village","bottom":"lawn","left":"village"},"connections":[[1,3]],"flags":["pennant"]},{"spritePath":"image--013.png","quantity":2,"sides":{"top":"village","right":"lawn","bottom":"lawn","left":"village"},"connections":[],"flags":[]},{"spritePath":"image--014.png","quantity":3,"sides":{"top":"village","right":"lawn","bottom":"village","left":"lawn"},"connections":[],"flags":[]},{"spritePath":"image--015.png","quantity":5,"sides":{"top":"village","right":"lawn","bottom":"lawn","left":"lawn"},"connections":[],"flags":[]},{"spritePath":"image--016.png","quantity":3,"sides":{"top":"village","right":"lawn","bottom":"road","left":"road"},"connections":[[2,3]],"flags":[]},{"spritePath":"image--017.png","quantity":3,"sides":{"top":"village","right":"road","bottom":"road","left":"lawn"},"connections":[[1,2]],"flags":[]},{"spritePath":"image--018.png","quantity":3,"sides":{"top":"village","right":"road","bottom":"road","left":"road"},"connections":[],"flags":[]},{"spritePath":"image--019.png","quantity":4,"sides":{"top":"village","right":"road","bottom":"lawn","left":"road"},"connections":[[1,3]],"flags":["root"]},{"spritePath":"image--020.png","quantity":8,"sides":{"top":"road","right":"lawn","bottom":"road","left":"lawn"},"connections":[[0,2]],"flags":[]},{"spritePath":"image--021.png","quantity":9,"sides":{"top":"lawn","right":"lawn","bottom":"road","left":"road"},"connections":[[2,3]],"flags":[]},{"spritePath":"image--022.png","quantity":4,"sides":{"top":"lawn","right":"road","bottom":"road","left":"road"},"connections":[],"flags":[]},{"spritePath":"image--023.png","quantity":1,"sides":{"top":"road","right":"road","bottom":"road","left":"road"},"connections":[],"flags":[]}]')},function(t){t.exports=JSON.parse('{"frames":{"avatar_1.png":{"frame":{"x":0,"y":0,"w":250,"h":250},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":250,"h":250},"sourceSize":{"w":250,"h":250}},"avatar_2.png":{"frame":{"x":250,"y":0,"w":250,"h":250},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":250,"h":250},"sourceSize":{"w":250,"h":250}},"avatar_3.png":{"frame":{"x":500,"y":0,"w":250,"h":250},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":250,"h":250},"sourceSize":{"w":250,"h":250}},"avatar_4.png":{"frame":{"x":750,"y":0,"w":250,"h":250},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":250,"h":250},"sourceSize":{"w":250,"h":250}},"avatar_5.png":{"frame":{"x":1000,"y":0,"w":250,"h":250},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":250,"h":250},"sourceSize":{"w":250,"h":250}},"avatar_6.png":{"frame":{"x":1250,"y":0,"w":250,"h":250},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":250,"h":250},"sourceSize":{"w":250,"h":250}}},"animations":{"avatar":["avatar_1.png","avatar_2.png","avatar_3.png","avatar_4.png","avatar_5.png","avatar_6.png"]},"meta":{"app":"https://www.codeandweb.com/texturepacker","version":"1.0","image":"2af92c13d9d287601a27701c24b934a2.png","format":"RGBA8888","size":{"w":1500,"h":250},"scale":"1","smartupdate":"$TexturePacker:SmartUpdate:72df0fb665234e19e9fcc93ad7adac51:ec2f7a49f1cb35215837ede46a9b0b5d:faac5bc2578b98332342aabac113e789$"}}')},function(t){t.exports=JSON.parse('{"frames":{"image--000.png":{"frame":{"x":0,"y":0,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128},"anchor":{"x":0.5,"y":0.5}},"image--001.png":{"frame":{"x":128,"y":0,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128},"anchor":{"x":0.5,"y":0.5}},"image--002.png":{"frame":{"x":0,"y":128,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128},"anchor":{"x":0.5,"y":0.5}},"image--003.png":{"frame":{"x":128,"y":128,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128},"anchor":{"x":0.5,"y":0.5}},"image--004.png":{"frame":{"x":0,"y":256,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128},"anchor":{"x":0.5,"y":0.5}},"image--005.png":{"frame":{"x":128,"y":256,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128},"anchor":{"x":0.5,"y":0.5}},"image--006.png":{"frame":{"x":0,"y":384,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128},"anchor":{"x":0.5,"y":0.5}},"image--007.png":{"frame":{"x":128,"y":384,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128},"anchor":{"x":0.5,"y":0.5}},"image--008.png":{"frame":{"x":0,"y":512,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128},"anchor":{"x":0.5,"y":0.5}},"image--009.png":{"frame":{"x":128,"y":512,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128},"anchor":{"x":0.5,"y":0.5}},"image--010.png":{"frame":{"x":0,"y":640,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128},"anchor":{"x":0.5,"y":0.5}},"image--011.png":{"frame":{"x":128,"y":640,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128},"anchor":{"x":0.5,"y":0.5}},"image--012.png":{"frame":{"x":0,"y":768,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128},"anchor":{"x":0.5,"y":0.5}},"image--013.png":{"frame":{"x":128,"y":768,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128},"anchor":{"x":0.5,"y":0.5}},"image--014.png":{"frame":{"x":0,"y":896,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128},"anchor":{"x":0.5,"y":0.5}},"image--015.png":{"frame":{"x":128,"y":896,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128},"anchor":{"x":0.5,"y":0.5}},"image--016.png":{"frame":{"x":0,"y":1024,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128},"anchor":{"x":0.5,"y":0.5}},"image--017.png":{"frame":{"x":128,"y":1024,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128},"anchor":{"x":0.5,"y":0.5}},"image--018.png":{"frame":{"x":0,"y":1152,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128},"anchor":{"x":0.5,"y":0.5}},"image--019.png":{"frame":{"x":128,"y":1152,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128},"anchor":{"x":0.5,"y":0.5}},"image--020.png":{"frame":{"x":0,"y":1280,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128},"anchor":{"x":0.5,"y":0.5}},"image--021.png":{"frame":{"x":128,"y":1280,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128},"anchor":{"x":0.5,"y":0.5}},"image--022.png":{"frame":{"x":0,"y":1408,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128},"anchor":{"x":0.5,"y":0.5}},"image--023.png":{"frame":{"x":128,"y":1408,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128},"anchor":{"x":0.5,"y":0.5}}},"animations":{"image-":["image--000.png","image--001.png","image--002.png","image--003.png","image--004.png","image--005.png","image--006.png","image--007.png","image--008.png","image--009.png","image--010.png","image--011.png","image--012.png","image--013.png","image--014.png","image--015.png","image--016.png","image--017.png","image--018.png","image--019.png","image--020.png","image--021.png","image--022.png","image--023.png"]},"meta":{"app":"https://www.codeandweb.com/texturepacker","version":"1.0","image":"cards.png","format":"RGBA8888","size":{"w":256,"h":1536},"scale":"1","smartupdate":"$TexturePacker:SmartUpdate:231098001aaa633512602a6519d0f7d7:04a000e2cc314d978a2c439d8d0f0a4c:8056528aade6b91f4a89f8c9da7f2d4c$"}}')},function(t){t.exports=JSON.parse('{"frames":{"pawn_1.png":{"frame":{"x":0,"y":0,"w":100,"h":250},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":100,"h":250},"sourceSize":{"w":100,"h":250}},"pawn_2.png":{"frame":{"x":0,"y":250,"w":100,"h":250},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":100,"h":250},"sourceSize":{"w":100,"h":250}},"pawn_3.png":{"frame":{"x":0,"y":500,"w":100,"h":250},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":100,"h":250},"sourceSize":{"w":100,"h":250}},"pawn_4.png":{"frame":{"x":0,"y":750,"w":100,"h":250},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":100,"h":250},"sourceSize":{"w":100,"h":250}},"pawn_5.png":{"frame":{"x":0,"y":1000,"w":100,"h":250},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":100,"h":250},"sourceSize":{"w":100,"h":250}},"pawn_6.png":{"frame":{"x":0,"y":1250,"w":100,"h":250},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":100,"h":250},"sourceSize":{"w":100,"h":250}}},"animations":{"pawn":["pawn_1.png","pawn_2.png","pawn_3.png","pawn_4.png","pawn_5.png"]},"meta":{"app":"https://www.codeandweb.com/texturepacker","version":"1.0","image":"a855f2851c0ed1548867501fe2686f89.png","format":"RGBA8888","size":{"w":100,"h":1500},"scale":"1","smartupdate":"$TexturePacker:SmartUpdate:f68f4c65a2930fae54d9c052c971339a:ffe5fcfcc79a5e21c88a1d38a1722897:7d812275c28d3f970a70492e3ef6ddcc$"}}')},function(t){t.exports=JSON.parse('{"frames":{"bag_closed.png":{"frame":{"x":0,"y":0,"w":500,"h":500},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":500,"h":500},"sourceSize":{"w":500,"h":500}},"bag_opened.png":{"frame":{"x":500,"y":0,"w":500,"h":500},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":500,"h":500},"sourceSize":{"w":500,"h":500}}},"meta":{"app":"https://www.codeandweb.com/texturepacker","version":"1.0","image":"24af530225116ed6603bda2d50eb3f60.png","format":"RGBA8888","size":{"w":1000,"h":500},"scale":"1","smartupdate":"$TexturePacker:SmartUpdate:bd3cc4d51e84c6db0a5f6297b0804f0a:cb93a83958af7d704df7acb650ce9f40:7870ea5540516ed6b1d23b65e6fcbb6e$"}}')},,,function(t,e){function n(t){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id=35},,,,,,,function(t,e,n){"use strict";n(12)},function(t,e,n){(e=n(3)(!1)).push([t.i,"\n.sprite-background[data-v-3229ae86] {\n    width: 100%;\n    height: 100%;\n    text-align: center;\n}\n.sprite[data-v-3229ae86] {\n    display: inline-block;\n    height: 100%;\n}\n\n",""]),t.exports=e},function(t,e,n){"use strict";n(13)},function(t,e,n){(e=n(3)(!1)).push([t.i,"\n.color[data-v-4bb55145] {\n    display: inline-block;\n\n    margin: 5px;\n    width: 50px;\n    height: 50px;\n    border-radius: 3px;\n}\n.color[data-v-4bb55145]:hover {\n    cursor: pointer;\n}\n",""]),t.exports=e},function(t,e,n){"use strict";n(14)},function(t,e,n){(e=n(3)(!1)).push([t.i,"\n.avatar[data-v-2a987e20] {\n    height: 250px;\n}\n.avatar .preview[data-v-2a987e20] {\n    display: inline-block;\n    height: 100%;\n}\n.avatar .back[data-v-2a987e20], .next[data-v-2a987e20] {\n    display: inline-block;\n    height: 100%;\n    vertical-align: top;\n    width: 50px;\n}\n.avatar .back[data-v-2a987e20] {\n    border-top-left-radius: 3px;\n    border-bottom-left-radius: 3px;\n}\n.avatar .next[data-v-2a987e20] {\n    border-top-right-radius: 3px;\n    border-bottom-right-radius: 3px;\n}\n.color-pool[data-v-2a987e20] {\n    margin-top: 25px;\n}\n\n",""]),t.exports=e},function(t,e,n){"use strict";n(15)},function(t,e,n){var i=n(3),a=n(50),s=n(51);e=i(!1);var r=a(s);e.push([t.i,"\n.credits[data-v-539f2bff] {\n    text-align: right;\n    padding: 20px;\n}\n.github[data-v-539f2bff] {\n    display: inline-block;\n    width: 32px;\n    height: 32px;\n    background-image: url("+r+");\n}\n.github[data-v-539f2bff]:hover {\n    opacity: 0.5;\n}\n.upperlevel[data-v-539f2bff] {\n    color: white;\n}\n.upperlevel[data-v-539f2bff]:hover {\n    opacity: 0.5;\n}\n\n",""]),t.exports=e},,function(t,e,n){"use strict";n.r(e),e.default=n.p+"266ca63177bca6f330a74e83fdc63178.png"},function(t,e,n){"use strict";n(16)},function(t,e,n){(e=n(3)(!1)).push([t.i,"\n.form[data-v-9d20e81a] {\n    text-align: center;\n}\nlabel[data-v-9d20e81a], input[type=text][data-v-9d20e81a] {\n    display: block;\n    color: white;\n    width: 100%;\n}\n\n/*\ninput[type=text] {\n    margin-top: 14px;\n\n    background-color: #593726;\n    border: none;\n    border-radius: 2px;\n    padding: 12px 6px;\n    outline: none;\n}*/\n.insert-name[data-v-9d20e81a] {\n    display: inline-block;\n}\n.edit-avatar[data-v-9d20e81a] {\n    margin-top: 35px;\n}\n.text-error[data-v-9d20e81a] {\n    padding-top: 17px;\n    padding-bottom: 17px;\n}\n\n\n",""]),t.exports=e},function(t,e,n){"use strict";n(17)},function(t,e,n){(e=n(3)(!1)).push([t.i,"\n.modal[data-v-00da2c44] {\n    display: none;\n    position: fixed;\n    top: 0;\n    width: 100%;\n    height: 100%;\n    z-index: 1000;\n\n    background-color: rgba(0, 0, 0, 0.25);\n    text-align: center;\n}\n.modal-content[data-v-00da2c44] {\n    position: relative;\n    display: inline-block;\n    top: 50%;\n    transform: translateY(-50%);\n}\n.close-btn[data-v-00da2c44] {\n    background-color: transparent;\n    color: white;\n    font-weight: bold;\n    border: none;\n    outline: none;\n}\n.close-btn[data-v-00da2c44]:hover {\n    cursor: pointer;\n}\n\n",""]),t.exports=e},function(t,e,n){"use strict";n(18)},function(t,e,n){(e=n(3)(!1)).push([t.i,"\n.how-to-play[data-v-645f09ea] {\n    text-align: justify;\n\n    background-color: #faf8f0;\n    color: black;\n}\n",""]),t.exports=e},function(t,e,n){"use strict";n(19)},function(t,e,n){(e=n(3)(!1)).push([t.i,"\n.how-to-play[data-v-044ef08f] {\n    width: 400px;\n    padding: 35px;\n}\n",""]),t.exports=e},function(t,e,n){"use strict";n(20)},function(t,e,n){(e=n(3)(!1)).push([t.i,"\n.invite-container[data-v-78a2504a] {\n    text-align: center;\n    padding-top: 15px;\n    padding-bottom: 15px;\n}\n.player-container[data-v-78a2504a] {\n    text-align: center;\n    padding-top: 15px;\n    padding-bottom: 15px;\n}\n.player[data-v-78a2504a] {\n    display: inline-block;\n    vertical-align: top;\n\n    text-align: center;\n\n    background-color: rgba(0, 0, 0, 0.25);\n    border-radius: 5px;\n\n    padding-top: 10px;\n    padding-bottom: 10px;\n\n    margin-left: 15px;\n    margin-right: 15px;\n\n    width: 140px;\n    max-width: 140px;\n\n    height: 170px;\n    max-height: 170px;\n}\n.player-avatar[data-v-78a2504a] {\n    display: inline-block;\n    width: 120px;\n    height: 120px;\n}\n.player-name[data-v-78a2504a] {\n    text-shadow: 1px 0 0 black, -1px 0 0 black, 0 1px 0 black, 0 -1px 0 black, 1px 1px black, -1px -1px 0 black, 1px -1px 0 black, -1px 1px 0 black;\n}\n.start-container[data-v-78a2504a] {\n    text-align: center;\n    margin-bottom: 100px;\n}\n",""]),t.exports=e},function(t,e,n){"use strict";n(21)},function(t,e,n){(e=n(3)(!1)).push([t.i,"\n.player-bar[data-v-4ed698f9] {\n    text-align: center;\n    padding: 13px;\n\n    pointer-events: none;\n}\n.player[data-v-4ed698f9] {\n    text-align: center;\n    display: inline-block;\n\n    padding-top: 10px;\n    padding-bottom: 10px;\n\n    border-radius: 5px;\n\n    text-shadow: 1px 0 0 black, -1px 0 0 black, 0 1px 0 black, 0 -1px 0 black, 1px 1px black, -1px -1px 0 black, 1px -1px 0 black, -1px 1px 0 black;\n\n    margin-right: 13px;\n\n    width: 120px;\n    max-width: 120px;\n\n    pointer-events: auto;\n}\n.player .avatar[data-v-4ed698f9] {\n    display: inline-block;\n\n    width: 85px;\n    height: 85px;\n}\n.player .name[data-v-4ed698f9] {\n    font-size: 14px;\n    padding-top: 5px;\n}\n.player .score[data-v-4ed698f9] {\n    font-size: 34px;\n}\n.player .pawn[data-v-4ed698f9] {\n    display: inline-block;\n}\n",""]),t.exports=e},function(t,e,n){"use strict";n(22)},function(t,e,n){(e=n(3)(!1)).push([t.i,"\n.bag-sprite[data-v-514f47cf] {\n    width: 250px;\n    height: 250px;\n}\n.bag-text[data-v-514f47cf] {\n    text-align: center;\n\n    font-weight: bold;\n    color: white;\n    margin-top: -52px;\n}\n\n",""]),t.exports=e},function(t,e,n){"use strict";n(23)},function(t,e,n){(e=n(3)(!1)).push([t.i,"\n.hint[data-v-8a8a835a] {\n    text-shadow: -1px -1px 0 black, 1px -1px 0 black, -1px  1px 0 black, 1px  1px 0 black;\n}\n.hint .other-round[data-v-8a8a835a] {\n    color: red;\n}\n.hint .my-round[data-v-8a8a835a] {\n    color: yellow;\n}\n.hint .my-round .card-draw[data-v-8a8a835a] {\n    font-size: 30px;\n    text-transform: uppercase;\n}\n",""]),t.exports=e},function(t,e,n){"use strict";n(24)},function(t,e,n){(e=n(3)(!1)).push([t.i,"\n.game[data-v-25ba038a] {\n    user-select: none;\n}\n.hint[data-v-25ba038a] {\n    position: absolute;\n    bottom: 105px;\n    width: 100%;\n    z-index: 40;\n    text-align: center;\n\n    pointer-events: none;\n}\n.game-bar[data-v-25ba038a] {\n    position: fixed;\n    bottom: 0;\n    width: 100%;\n    z-index: 25;\n\n    pointer-events: none;\n}\n.player-bar[data-v-25ba038a] {\n    position: fixed;\n    top: 0;\n    width: 100%;\n    z-index: 1;\n}\n.scoreboard[data-v-25ba038a] {\n    position: absolute;\n\n    top: 35%;\n    width: 100%;\n    text-align: center;\n\n    z-index: 50;\n\n    pointer-events: none;\n}\n.scoreboard table[data-v-25ba038a] {\n    display: inline-block;\n\n    padding: 25px;\n\n    color: white;\n    background-color: rgba(0, 10, 18, 0.7);\n\n    border-radius: 15px;\n    border: 1px solid #263238;\n\n    pointer-events: none;\n}\n.scoreboard table tr[data-v-25ba038a] {\n    border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n\n    pointer-events: none;\n}\n.scoreboard table tr th[data-v-25ba038a] {\n    padding-left: 15px;\n    padding-right: 15px;\n}\n.scoreboard .username[data-v-25ba038a] {\n}\n.end[data-v-25ba038a] {\n    text-align: center;\n\n    pointer-events: none;\n}\n.end .winner[data-v-25ba038a] {\n    color: gold;\n    text-shadow: -1px -1px 0 black, 1px -1px 0 black, -1px  1px 0 black, 1px  1px 0 black;\n\n    pointer-events: none;\n}\n.end .description[data-v-25ba038a] {\n    color: gold;\n    text-shadow: -1px -1px 0 black, 1px -1px 0 black, -1px  1px 0 black, 1px  1px 0 black;\n\n    pointer-events: none;\n}\n.end .countdown[data-v-25ba038a] {\n    color: white;\n    text-shadow: -1px -1px 0 black, 1px -1px 0 black, -1px  1px 0 black, 1px  1px 0 black;\n\n    pointer-events: none;\n}\n.bag[data-v-25ba038a] {\n    display: inline-block;\n    vertical-align: bottom;\n\n    pointer-events: auto;\n}\n.pawn-container[data-v-25ba038a] {\n    display: inline-block;\n    vertical-align: bottom;\n\n    width: 140px;\n    height: 70px;\n    border-top-left-radius: 5px;\n    border-top-right-radius: 5px;\n\n    background-color: rgba(0, 0, 0, 0.30);\n\n    pointer-events: auto;\n}\n.pawn[data-v-25ba038a] {\n    display: inline-block;\n\n    width: 28px;\n    height: 70px;\n}\n.button-bar[data-v-25ba038a] {\n    text-align: center;\n\n    padding: 20px;\n\n    pointer-events: auto;\n}\n\n",""]),t.exports=e},function(t,e,n){var i=n(71);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,n(4).default)("511f390e",i,!1,{})},function(t,e,n){(e=n(3)(!1)).push([t.i,"@import url(https://fonts.googleapis.com/css2?family=Merienda+One&display=swap);"]),e.push([t.i,"* {\n    margin: 0;\n    font-family: 'Merienda One', cursive;\n}\n\nbody {\n    color: white;\n\n    background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAAPklEQVQoU2NkYGAwZmBgOMsAASD2cwYGhmcwPiOUIcXAwCCJpBDOhynA0AkzCaQA2QoMk0AKQIJwO+nvBmMAk2YWvDhYBRoAAAAASUVORK5CYII=);\n    background-color: #6e472c;\n}\n\n.phase-container {\n}\n\n.title-container {\n    padding-top: 3%;\n    padding-bottom: 3%;\n\n    text-align: center;\n}\n\n.title {\n    font-family: 'Merienda One', serif;\n    font-size: 3em;\n\n    color: #ffd324;\n    text-shadow: -2px -2px 2px black;\n}\n\n.secondary-btn {\n    background-color: #6e472c;\n    color: rgba(255, 255, 255, 1);\n    border: none;\n    outline: none;\n}\n\n.secondary-btn:hover {\n    cursor: pointer;\n    background-color: #7e5330;\n}\n\n.secondary-btn[disabled] {\n    cursor: default;\n    color: rgba(255, 255, 255, 0.5);\n    background-color: #7e5330;\n}\n\n.info-btn {\n    background-color: #faf8f0;\n    color: black;\n    border: none;\n    outline: none;\n}\n\n.info-btn:hover {\n    cursor: pointer;\n    background-color: white;\n}\n\ninput[type=text] {\n    background-color: #6e472c;\n    border: none;\n    border-radius: 2px;\n    padding: 12px 6px;\n    outline: none;\n}\n\n.btn {\n    font-size: 14px;\n    border-radius: 2px;\n    padding: 16px 24px;\n}\n\n.btn::-moz-focus-inner {\n    border: none;\n    outline: none;\n}\n\n.btn-sm {\n    font-size: 10px;\n    padding: 8px 10px;\n}\n\n.primary-btn {\n    color: rgba(0, 0, 0, 1);\n    background-color: #ffd324;\n    border: none;\n    outline: none;\n}\n\n.primary-btn:hover {\n    cursor: pointer;\n    background-color: #ffe666;\n}\n\n.primary-btn[disabled] {\n    cursor: default;\n    color: rgba(0, 0, 0, 0.5);\n    background-color: #ffe666;\n}\n\n.text-primary {\n    color: #ffd324;\n}\n\n.text-success {\n    color: #B2FF59;\n}\n\n.text-info {\n    color: #EEEEEE;\n}\n\n.text-error {\n    color: red;\n    text-shadow: 1px 1px 5px black;\n}\n\n@media screen and (max-height: 890px) {\n    .footer {\n        position: static;\n    }\n}\n\n@media screen and (min-height: 890px) {\n    .footer {\n        position: fixed;\n        bottom: 0;\n    }\n}\n\n.footer, .game-footer {\n    width: 100%;\n    background-color: rgba(0, 0, 0, 0.25);\n}\n",""]),t.exports=e},function(t,e,n){"use strict";n.r(e),n.d(e,"windowEventEmitter",(function(){return me})),n.d(e,"app",(function(){return fe})),n.d(e,"channel",(function(){return ve})),n.d(e,"stage",(function(){return we}));var i=n(1),a=n(6);class s{constructor(t){this.name=t,this.uiEventEmitter=new a}log(t){console.log(`[${this.name}] `+t)}ui(){}enable(){this.log("Enabling"),i.a.prototype.eventEmitter=this.uiEventEmitter,this.vue=this.ui(),this.vue&&(this.vue.$mount(),document.body.appendChild(this.vue.$el))}disable(){console.log(`[${this.name}] Disabling`),this.vue&&document.body.removeChild(this.vue.$el)}}var r=function(){var t=this.$createElement;this._self._c;return this._m(0)};r._withStripped=!0;var o=i.a.extend(),l=n(2),h=Object(l.a)(o,r,[function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("div",{staticClass:"title-container"},[e("h1",{staticClass:"title"},[this._v("Carcassonne")]),this._v(" "),e("small",[this._v("Loading...")])])])}],!1,null,null,null);h.options.__file="src/app/ui/loading/loading.vue";var d=h.exports;class c extends s{constructor(){super("loading")}ui(){return new d}enable(){super.enable()}disable(){super.disable()}}var p=n(25),u=n.n(p);class g{constructor(t,e){this.parent=e,this.connection=t,t.on("open",this.onOpen.bind(this)),t.on("data",this.onData.bind(this)),t.on("close",this.onClose.bind(this)),t.on("error",this.onError.bind(this))}getId(){return this.connection.peer}sendData(t){this.connection.send(t)}onOpen(){this.parent.registerConnection(this)}onData(t){this.parent.onDataReceived(t,this.connection.peer)}onClose(){this.parent.unregisterConnection(this)}onError(t){console.log("Connection error",t)}close(){this.connection.close()}}var m=function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"phase-container"},[this._m(0),this._v(" "),e("login-form",{ref:"form"}),this._v(" "),e("div",{staticStyle:{"text-align":"center"}},[e("button",{staticClass:"info-btn btn",on:{click:this.howToPlay}},[this._v("How to Play?")])]),this._v(" "),e("modal-component",{ref:"howToPlay"},[e("how-to-play-component",{staticClass:"how-to-play"})],1),this._v(" "),e("footer-component")],1)};m._withStripped=!0;var f=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"form"},[n("div",{staticClass:"insert-name"},[n("label",{staticStyle:{"margin-bottom":"7px"}},[t._v("Insert your name here:")]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],attrs:{type:"text",spellcheck:"false"},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value)}}})]),t._v(" "),n("div",{staticClass:"edit-avatar",staticStyle:{"margin-top":"30px"}},[n("label",{staticStyle:{"margin-bottom":"7px"}},[t._v("Choose your avatar:")]),t._v(" "),n("avatar-editor",{ref:"editor"})],1),t._v(" "),n("button",{staticClass:"btn primary-btn",staticStyle:{"margin-top":"30px"},attrs:{disabled:!t.canSubmit()},on:{click:function(e){return t.submit()}}},[t._v("\n        Play!\n    ")]),t._v(" "),n("div",{staticClass:"text-error"},[t._v(t._s(t.errorMessage))])])};f._withStripped=!0;var v=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"avatar"},[n("button",{staticClass:"btn secondary-btn back",on:{click:function(e){return t.prevAvatar()}}},[t._v("<")]),t._v(" "),n("avatar-component",{staticClass:"preview",attrs:{"avatar-id":t.avatarId,color:this.color}}),t._v(" "),n("button",{staticClass:"btn secondary-btn next",on:{click:function(e){return t.nextAvatar()}}},[t._v(">")])],1),t._v(" "),n("div",{staticClass:"color-pool"},[n("color-pool-component",{model:{value:t.color,callback:function(e){t.color=e},expression:"color"}})],1)])};v._withStripped=!0;var w=function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("div",{staticClass:"sprite-background",style:{backgroundColor:this.colorToStr(this.color),zIndex:-1}},[e("div",{ref:"sprite",staticClass:"sprite",style:this.getSpriteStyle()})])])};w._withStripped=!0;var y=n(0),b=n.p+"2af92c13d9d287601a27701c24b934a2.png",x=i.a.extend({props:{avatarId:Number,color:Number},methods:{colorToStr:t=>`\n                rgb(\n                    ${t>>16&255},\n                    ${t>>8&255},\n                    ${255&t}\n                )\n            `,resizeFrame(){const t=this.getSprite().orig,e=t.width/t.height*this.$refs.sprite.clientHeight;this.$refs.sprite.style.width=e+"px"},getSprite(){return y.f.shared.resources.avatars.spritesheet.textures["avatar_"+this.avatarId+".png"]},getSpriteStyle(){const t=this.getSprite();if(t){const e=t.orig,n=t.baseTexture,i={x:n.width/e.width*100,y:n.height/e.height*100},a={x:e.x/(n.width-e.width+Number.EPSILON)*100,y:e.y/(n.height-e.height+Number.EPSILON)*100};return{backgroundPosition:`${a.x}% ${a.y}%`,backgroundSize:`${i.x}% ${i.y}%`,backgroundImage:"url("+b+")",zIndex:0}}return{}}},mounted(){me.on("resize",this.resizeFrame,this),this.$nextTick(()=>{this.resizeFrame()})},beforeDestroy(){me.off("resize",this.resizeFrame,this)}}),S=(n(42),Object(l.a)(x,w,[],!1,null,"3229ae86",null));S.options.__file="src/app/ui/avatar.vue";var _=S.exports,C=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",t._l(this.colors,(function(e){return n("div",{staticClass:"color",style:{backgroundColor:t.colorToStr(e)},on:{click:function(n){return t.$emit("input",e)}}})})),0)};C._withStripped=!0;var P=i.a.extend({data:()=>({colors:[13959168,16739584,16761856,16776960,6610199,51283,47316,3162015,16744619,11225020,4854924,16119285,1710618,5125166]}),methods:{colorToStr:t=>`\n                rgb(\n                    ${t>>16&255},\n                    ${t>>8&255},\n                    ${255&t}\n                )\n            `}}),E=(n(44),Object(l.a)(P,C,[],!1,null,"4bb55145",null));E.options.__file="src/app/ui/login/colorPool.vue";var k=E.exports,I=i.a.extend({data:()=>({avatarId:1,color:13959168}),components:{AvatarComponent:_,ColorPoolComponent:k},methods:{verifyAvatarId:t=>void 0!==y.f.shared.resources.avatars.spritesheet.textures["avatar_"+t+".png"],prevAvatar(){this.verifyAvatarId(this.avatarId-1)&&this.avatarId--},nextAvatar(){this.verifyAvatarId(this.avatarId+1)&&this.avatarId++}}}),T=(n(46),Object(l.a)(I,v,[],!1,null,"2a987e20",null));T.options.__file="src/app/ui/login/avatarEditor.vue";var z=T.exports,O=function(){var t=this.$createElement;this._self._c;return this._m(0)};O._withStripped=!0;var R=i.a.extend({}),M=(n(48),Object(l.a)(R,O,[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"footer"},[e("div",{staticClass:"credits"},[e("div",{staticClass:"links"},[e("a",{staticClass:"github",attrs:{href:"https://github.com/upperlevel/carcassonne",target:"_blank"}})]),this._v(" "),e("small",{staticStyle:{color:"lightgray"}},[this._v("\n            Developed by "),e("a",{staticClass:"upperlevel",attrs:{href:"https://github.com/upperlevel",target:"_blank"}},[this._v("Upperlevel")]),this._v(" /\n            Drawings by "),e("span",{staticStyle:{color:"white"}},[this._v("Giorgia Nizzoli")])])])])}],!1,null,"539f2bff",null));M.options.__file="src/app/ui/footer.vue";var A=M.exports,B=i.a.extend({data:()=>({name:"",errorMessage:""}),components:{AvatarEditor:z,FooterComponent:A},methods:{canSubmit(){return!(this.name.length<1||this.name.length>12||!/^[a-zA-Z0-9_]*$/.test(this.name))},submit(){if(!this.canSubmit())return;const t=this.$refs.editor;this.eventEmitter.emit("submit",{username:this.name,color:t.color,avatar:t.avatarId})}}}),D=(n(52),Object(l.a)(B,f,[],!1,null,"9d20e81a",null));D.options.__file="src/app/ui/login/loginForm.vue";var L=D.exports,$=function(){var t=this.$createElement,e=this._self._c||t;return e("div",{ref:"modal",staticClass:"modal",on:{click:this.close}},[e("div",{staticClass:"modal-content"},[e("div",{staticStyle:{"text-align":"right"}},[e("button",{staticClass:"close-btn btn",on:{click:this.close}},[this._v("X")])]),this._v(" "),this._t("default")],2)])};$._withStripped=!0;var F=i.a.extend({methods:{open(){this.$refs.modal.style.display="block"},close(){this.$refs.modal.style.display="none"}}}),N=(n(54),Object(l.a)(F,$,[],!1,null,"00da2c44",null));N.options.__file="src/app/ui/util/modal.vue";var U=N.exports,j=function(){var t=this.$createElement;this._self._c;return this._m(0)};j._withStripped=!0;var Y={name:"howToPlay.vue"},q=(n(56),Object(l.a)(Y,j,[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"how-to-play"},[n("h2",{staticStyle:{"margin-bottom":"15px"}},[t._v("How to play Carcassonne?")]),t._v(" "),n("p",[t._v("\n        The game is divided in turns.\n        "),n("br"),t._v("\n        Every turn the player has to draw a card from the bag and place it on the map where possible.\n        After placing the card, the player can decide to own the structure formed (a village or a road) by placing a pawn on it.\n        "),n("br"),t._v("\n        If the structure was already owned by another player, this can't be done.\n        After closing a structure, the players that have the highest number of pawns within it will receive the same amount of points.\n        "),n("br"),t._v("\n        The game ends when the bag's empty and the winner is the player that scored higher points.\n    ")]),t._v(" "),n("div",{staticStyle:{"margin-top":"15px","text-align":"center"}},[n("small",[t._v("1/1")])])])}],!1,null,"645f09ea",null));q.options.__file="src/app/ui/howToPlay.vue";var G=q.exports,H=i.a.extend({components:{LoginForm:L,FooterComponent:A,ModalComponent:U,HowToPlayComponent:G},methods:{howToPlay(){this.$refs.howToPlay.open()}}}),X=(n(58),Object(l.a)(H,m,[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title-container"},[e("h1",{staticClass:"title"},[this._v("Carcassonne")]),this._v(" "),e("p",[this._v("Carcassonne board game brought online!")])])}],!1,null,"044ef08f",null));X.options.__file="src/app/ui/login/login.vue";var Z=X.exports,W=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"phase-container"},[n("div",{staticClass:"title-container"},[n("h1",{staticClass:"title"},[t._v("Carcassonne")]),t._v(" "),this.playersCount()<2?n("div",{staticStyle:{color:"#B2FF59"}},[t._v("\n            Invite friends to play Carcassonne with you, the minimum number of players requested to start is 2.\n        ")]):n("div",{staticClass:"text-primary"},[this.me.isHost?n("div",[t._v("\n                When you're ready press start!\n            ")]):n("div",{staticClass:"text-info"},[t._v("\n                Only the guy with the underlined name can start.\n            ")])])]),t._v(" "),n("div",{staticStyle:{"text-align":"center"}},[t._v("\n        Players: "+t._s(this.playersCount())+"\n    ")]),t._v(" "),n("div",{staticClass:"invite-container"},[n("button",{staticClass:"btn-sm primary-btn",on:{click:t.onCopyInviteLink}},[t._v("Copy invite link")]),t._v(" "),t.inviteLinkCopied?n("small",[t._v("Copied to clipboard!")]):t._e()]),t._v(" "),n("div",{staticClass:"player-container"},t._l(Object.values(this.playersById),(function(e){return n("div",{staticClass:"player"},[n("avatar-component",{staticClass:"player-avatar",attrs:{"avatar-id":e.avatar,color:e.color}}),t._v(" "),n("div",{staticClass:"player-name",style:t.getNameStyle(e)},[t._v("\n                "+t._s(e.username)+"\n            ")]),t._v(" "),e.id===t.me.id?n("div",{staticClass:"player-name",style:t.getNameStyle(e)},[t._v("\n                (You)\n            ")]):t._e()],1)})),0),t._v(" "),this.me.isHost?n("div",{staticClass:"start-container"},[n("button",{staticClass:"btn primary-btn",attrs:{disabled:!t.canStart()},on:{click:t.onStart}},[t._v("Start")])]):t._e(),t._v(" "),n("footer-component")],1)};W._withStripped=!0;var V=i.a.extend({data:()=>({inviteLinkCopied:!1}),components:{AvatarComponent:_,FooterComponent:A},methods:{playersCount(){return Object.keys(this.playersById).length},getNameStyle(t){return{color:t.id===this.me.id?"yellow":"white",textDecoration:t.isHost?"underline":"none"}},canStart(){return this.me.isHost&&this.playersCount()>1},onStart(){this.eventEmitter.emit("start")},onCopyInviteLink(){const t=window.location.href;navigator.clipboard.writeText(t),this.inviteLinkCopied=!0}}}),J=(n(60),Object(l.a)(V,W,[],!1,null,"78a2504a",null));J.options.__file="src/app/ui/room/room.vue";var K,Q=J.exports,tt=n(28);class et{constructor(t,e){this.cards=e,this.gamePhase=t,this.uiEventEmitter=this.gamePhase.uiEventEmitter;const n=y.f.shared.resources.bag.spritesheet;this.bagOpenedFrame=n.textures["bag_opened.png"].orig,this.bagClosedFrame=n.textures["bag_closed.png"].orig}canPlaceCard(){return this.gamePhase.isMyRound()&&this.gamePhase.roundState==te.CardDraw}onBagOver(t){this.canPlaceCard()&&(t.frame=this.bagOpenedFrame,t.$el.style.cursor="pointer")}onBagClick(t){this.canPlaceCard()&&this.gamePhase.onDraw()}onBagLeave(t){t.frame=this.bagClosedFrame,t.$el.style.cursor="auto"}listen(){this.uiEventEmitter.on("bag-over",this.onBagOver,this),this.uiEventEmitter.on("bag-click",this.onBagClick,this),this.uiEventEmitter.on("bag-leave",this.onBagLeave,this)}unlisten(){this.uiEventEmitter.off("bag-over",this.onBagOver,this),this.uiEventEmitter.off("bag-click",this.onBagClick,this),this.uiEventEmitter.off("bag-leave",this.onBagLeave,this)}draw(){return this.cards.shift()}size(){return this.cards.length}static fromModality(t){let e=et.duplicateCards(tt),n=et.findFirstInitialCard(e);return[e[0],e[n]]=[e[n],e[0]],new et(t,e)}static duplicateCards(t){return t}static findFirstCardFlag(t,e,n){let i=t.length;for(let a=e;a<i;a++)if(t[a].flags.indexOf(n)>=0)return a}static findFirstInitialCard(t){return this.findFirstCardFlag(t,0,"root")}}!function(t){t[t.TOP=0]="TOP",t[t.RIGHT=1]="RIGHT",t[t.BOTTOM=2]="BOTTOM",t[t.LEFT=3]="LEFT"}(K||(K={}));class nt{static getNeighbourCoords(t){switch(t){case K.TOP:return[0,-1];case K.RIGHT:return[1,0];case K.BOTTOM:return[0,1];case K.LEFT:return[-1,0]}return[0,0]}static invert(t){return(t+2)%4}static toStr(t){switch(t){case K.TOP:return"top";case K.RIGHT:return"right";case K.BOTTOM:return"bottom";case K.LEFT:return"left"}}}nt.all=[0,1,2,3];class it{constructor(t,e){this.card=t,this.rotation=e||0,this.paths=[-1,-1,-1,-1],t.flags.indexOf("monastery")>=0&&(this.monasteryData=new at)}getSideType(t){switch((t+this.rotation)%4){case K.TOP:return this.card.sides.top;case K.RIGHT:return this.card.sides.right;case K.BOTTOM:return this.card.sides.bottom;case K.LEFT:return this.card.sides.left}}getSideConnections(t){let e=(t+this.rotation)%4,n=this.card.connections.find((function(t){return t.indexOf(e)>-1}));return null==n?[t]:n.map(t=>(t+4-this.rotation)%4)}isCompatible(t,e){return this.getSideType(t)==e.getSideType(nt.invert(t))}createSprite(){let t=y.f.shared.resources,e=new y.j(t.cards.spritesheet.textures[this.card.spritePath]);return e.anchor.set(.5,.5),e.rotation=-this.rotation*Math.PI/2,e}}class at{constructor(){this.completedTiles=1}setPawn(t){return void 0!==this.pawn?(console.error("Monastery cannot have two pawns"),!1):(this.pawn=t,!0)}}class st{static isOwnable(t){return"lawn"!=t}}class rt extends y.d{constructor(t,e,n){super(),this.onEnd=()=>{},this.life=0,this.lifetime=rt.LIFETIME*n,this.board=t;let i=new y.e,a=new y.h;for(let t of e)this.board.cardCoordToRelPos(t[0],t[1],a),i.beginFill(255,.25),i.drawRect(a.x-gt.TILE_SIZE/2,a.y-gt.TILE_SIZE/2,gt.TILE_SIZE,gt.TILE_SIZE),i.endFill();this.update(),this.addChild(i),this.zIndex=100,fe.ticker.add(this.onTick,this)}update(){if(this.life>this.lifetime)return fe.ticker.remove(this.onTick,this),this.parent.removeChild(this),void this.onEnd();let t=this.life/this.lifetime;this.alpha=Math.sin(t*Math.PI)}onTick(t){this.life+=t,this.update()}}rt.LIFETIME=40;class ot{constructor(t){this.runLater=[],this.isRunning=!1,this.onQueueEmpty=()=>{},this.phase=t}addAnimation(t){t.pawns.forEach(t=>t.setPending()),this.runLater.push(t),this.tryStart()}tryStart(){if(this.isRunning)return;let t=this.runLater.shift();if(void 0===t)return void this.onQueueEmpty();this.isRunning=!0;let e=1;this.phase.roundState==te.GameEnd&&(e=1.5);for(let n of t.pawns)n.returnToPlayer(e);let n=new rt(this.phase.board,t.tiles,e);this.phase.board.addChild(n),n.onEnd=this.onParticleEnd.bind(this)}onParticleEnd(){this.isRunning=!1,this.tryStart()}}class lt{constructor(t,e){this.tiles=t,this.pawns=e}}class ht{constructor(t){this.pathsToClose=new Array,this.board=t,this.pathData=new Map,this.nextId=0}canOwnPath(t,e,n){let i=this.board.get(t,e);if(void 0===i)return!1;if(!st.isOwnable(i.getSideType(n)))return!1;let a=i.paths[n];return!(a<0)&&0==this.pathData.get(a).followers.size}assignPath(t,e,n,i,a){void 0===a&&(a=!1);let s=this.board.get(t,e),r=s.getSideConnections(n),o=s.paths[n],l=this.pathData.get(i);for(let n of r){s.paths[n]=i;let r=nt.invert(n),h=this.board.getNeighbour(t,e,n);if(void 0===h){a||l.openEndCount++;continue}a||l.openEndCount--;let d=h.paths[r];if(d==i)continue;let c=nt.getNeighbourCoords(n);a||d==o||(l.merge(this.pathData.get(d)),this.pathData.delete(d)),this.assignPath(t+c[0],e+c[1],r,i,!0)}!a&&l.openEndCount<=0&&(l.pawns.length>0?this.closePath(i,!1):this.pathsToClose.push(i))}assignScore(t,e,n,i,a){let s=0,r=[[t,e,n]];for(;r.length>0;){[t,e,n]=r.pop(),void 0!==a&&a.push([t,e]);let o=this.board.get(t,e);switch(o.getSideType(n)){case"lawn":break;case"village":s+=(1+(o.card.flags.indexOf("pennant")>=0?1:0))*(i?1:2);break;case"road":s+=1}let l=o.paths[n];for(let n of nt.all){if(o.paths[n]!=l)continue;o.paths[n]=-2;let i=this.board.getNeighbour(t,e,n);if(void 0!==i&&i.paths[nt.invert(n)]>=0){let i=nt.getNeighbourCoords(n);r.push([t+i[0],e+i[1],nt.invert(n)])}}}return s}closePath(t,e){let n=this.pathData.get(t);if(n.pawns.length>0){let t=n.entryPoint.x,i=n.entryPoint.y,a=n.entryPoint.side,s=new Array,r=this.assignScore(t,i,a,e,s),o=n.getScoreWinners(),l=new Set(o);for(let t of n.pawns)l.has(t.owner.id)&&(t.addScore(r),l.delete(t.owner.id));let h=new lt(s,n.pawns);this.board.phase.pathAnimationScheduler.addAnimation(h)}this.pathData.delete(t)}createPath(t){let e=this.nextId;return this.nextId++,this.pathData.set(e,new ct(t)),e}initializePaths(t,e){let n=this.board.get(t,e),i=0;for(let a of nt.all){if(0!=(i&1<<a))continue;if(!st.isOwnable(n.getSideType(a)))continue;let s=n.getSideConnections(a);for(let t of s)i|=1<<t;let r=-1;for(let n of s){let i=this.board.getNeighbour(t,e,n);if(void 0!==i){r=i.paths[nt.invert(n)];break}}-1==r&&(r=this.createPath(new dt(t,e,a))),this.assignPath(t,e,a,r)}}addCard(t,e){return this.initializePaths(t,e),!0}onTurnEnd(t){for(;this.pathsToClose.length>0;){let e=this.pathsToClose.pop();this.closePath(e,t)}}onGameEnd(){this.pathData.forEach((t,e)=>{this.closePath(e,!0)})}ownPath(t,e,n,i){if(!this.canOwnPath(t,e,n))return!1;let a=this.board.get(t,e).paths[n];return this.pathData.get(a).addPawn(i),!0}getPathData(t,e,n){let i=this.board.get(t,e);if(void 0===i)return;let a=i.paths[n];return a<0?void 0:this.pathData.get(a)}canOwnAnyPath(t,e){let n=this.board.get(t,e);if(void 0===n)return!1;for(let t of nt.all){if(!st.isOwnable(n.getSideType(t)))continue;let e=n.paths[t];if(!(e<0)&&0==this.pathData.get(e).followers.size)return!0}return!1}}class dt{constructor(t,e,n){this.x=t,this.y=e,this.side=n}}class ct{constructor(t){this.followers=new Map,this.openEndCount=0,this.pawns=new Array,this.entryPoint=t}addFollower(t,e){let n=this.followers.get(t)||0;this.followers.set(t,n+(e||1))}merge(t){t.followers.forEach((t,e)=>{this.addFollower(e,t)}),this.pawns.push(...t.pawns),this.openEndCount+=t.openEndCount}getScoreWinners(){let t=0,e=[];return this.followers.forEach((n,i)=>{n>t?(t=n,e=[i]):n==t&&e.push(i)}),e}addPawn(t){this.addFollower(t.owner.id,1),this.pawns.push(t)}}class pt{constructor(t){this.monasteries=new Array,this.board=t}onTileAdd(t,e){void 0!==this.board.get(t,e).monasteryData&&this.monasteries.push(new y.h(t,e))}getPossiblePlacements(t){let e=this.board.gridSide,n=new Array,i=new it(t,0),a=-1;for(let t=0;t<e;t++)for(let s=0;s<e;s++){if(a++,s>0&&void 0!==this.board.grid[a-1]||s<e-1&&void 0!==this.board.grid[a+1]||t>0&&void 0!==this.board.grid[a-e]||t<e-1&&void 0!==this.board.grid[a+e])for(let e=0;e<4;e++)i.rotation=e,this.board.canSet(t,s,i)&&n.push(new ut(t,s,e))}return n}getAllMonasteries(){return this.monasteries}}class ut{constructor(t,e,n){this.x=t,this.y=e,this.rotation=n}}class gt extends y.d{constructor(t,e,n){super(),this.left=1/0,this.right=-1/0,this.bottom=1/0,this.top=-1/0,this.phase=t,this.gridSide=2*(e.size()-1)+1,this.grid=new Array(this.gridSide*this.gridSide),this.bag=e,this.cardConnector=new ht(this),this.rootCardTile=new it(n),this.tileDb=new pt(this),this.set(Math.floor(this.gridSide/2),Math.floor(this.gridSide/2),this.rootCardTile,!0),this.initPixi()}isBoardLost(t,e){const n=t.x+(this.left+1)*gt.TILE_SIZE*e.x,i=t.x+this.right*gt.TILE_SIZE*e.x,a=t.y+(this.bottom+1)*gt.TILE_SIZE*e.y;return t.y+this.top*gt.TILE_SIZE*e.y<0||a>window.innerHeight||n>window.innerWidth||i<0}initPixi(){this.sortableChildren=!0,this.hitArea={contains:(t,e)=>!0},this.interactive=!0,this.interactiveChildren=!0,this.isDragging=!1,this.on("mousedown",t=>{this.isDragging=!0}),this.on("mouseup",t=>{this.isDragging=!1}),this.on("mouseupoutside",t=>{this.isDragging=!1}),this.on("mousemove",t=>{if(this.isDragging){let e=t.data.originalEvent;const n=this.position.x+e.movementX,i=this.position.y+e.movementY;if(this.isBoardLost(new y.h(n,i),this.scale))return;this.position.x=n,this.position.y=i}})}flatIndex(t,e){return 0<=t&&t<this.gridSide&&0<=e&&e<this.gridSide?t*this.gridSide+e:-1}get(t,e){return this.grid[this.flatIndex(t,e)]}containerCoordsToTileCoords(t,e){e.x=Math.floor(t.x/gt.TILE_SIZE),e.y=Math.floor(t.y/gt.TILE_SIZE)}getNeighbour(t,e,n){let i=nt.getNeighbourCoords(n);return this.get(t+i[0],e+i[1])}canSet(t,e,n){let i=!1;if(void 0!==this.get(t,e))return!1;for(let a of nt.all){let s=nt.getNeighbourCoords(a),r=this.get(t+s[0],e+s[1]);if(i=i||void 0!==r,r&&!n.isCompatible(a,r))return!1}return i}getPossiblePlacements(t){return this.tileDb.getPossiblePlacements(t)}monasteryInit(t,e){let n=this.get(t,e);if(void 0===n||void 0===n.monasteryData)return;let i=1;for(let n of[-1,0,1])for(let a of[-1,0,1])0==n&&0==a||void 0!==this.get(t+n,e+a)&&(i+=1);n.monasteryData.completedTiles=i,9==i&&this.monasteryOnComplete(t,e)}monasteryOnComplete(t,e){let n=this.get(t,e);if(void 0===n)return;let i=n.monasteryData;if(void 0===i||null==i.pawn)return;let a=new Array;for(let n of[-1,0,1])for(let i of[-1,0,1])a.push([t+n,e+i]);i.pawn.addScore(9);let s=new lt(a,[i.pawn]);this.phase.pathAnimationScheduler.addAnimation(s),i.pawn=void 0}monasteryPlaceNeighbour(t,e){let n=this.get(t,e);if(void 0===n||void 0===n.monasteryData)return;let i=n.monasteryData;++i.completedTiles>=9&&void 0!==i.pawn&&this.monasteryOnComplete(t,e)}set(t,e,n,i){if(!this.canSet(t,e,n)&&!0!==i)return!1;this.grid[this.flatIndex(t,e)]=n,t<this.left&&(this.left=t,console.log("Left",t)),t>this.right&&(this.right=t,console.log("Right",t)),e<this.bottom&&(this.bottom=e,console.log("Bottom",e)),e>this.top&&(this.top=e,console.log("Top",e)),this.tileDb.onTileAdd(t,e),this.cardConnector.addCard(t,e);for(let n of[-1,0,1])for(let i of[-1,0,1])0==n&&0==i||this.monasteryPlaceNeighbour(t+n,e+i);let a=n.createSprite();return a.anchor.set(.5,.5),a.width=gt.TILE_SIZE,a.height=gt.TILE_SIZE,a.zIndex=0,this.cardCoordToRelPos(t,e,a.position),this.addChild(a),!0}onRoundEnd(t,e,n){this.monasteryInit(t,e),this.cardConnector.onTurnEnd(n)}onGameEnd(){this.cardConnector.onGameEnd(),this.tileDb.getAllMonasteries().forEach(t=>{let e=this.get(t.x,t.y).monasteryData;if(void 0!==e.pawn&&e.completedTiles<9){let n=new Array;for(let e of[-1,0,1])for(let i of[-1,0,1]){let a=t.x+e,s=t.y+i;void 0!==this.get(a,s)&&n.push([a,s])}e.pawn.addScore(e.completedTiles);let i=new lt(n,[e.pawn]);this.phase.pathAnimationScheduler.addAnimation(i),e.pawn=void 0}})}cardCoordToRelPos(t,e,n){const i=gt.TILE_SIZE;n.set(i/2+t*i,i/2+e*i)}}function mt(t,e){let n,i,a=t.length;e=e||1;let s=function(){const t=1e4*Math.sin(e++);return t-Math.floor(t)};for(;0!==a;)i=Math.floor(s()*a),a-=1,n=t[a],t[a]=t[i],t[i]=n;return t}gt.TILE_SIZE=120;var ft=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"game"},[n("player-bar-component",{staticClass:"player-bar",attrs:{players:this.players}}),t._v(" "),n("hint-bar-component",{staticClass:"hint",attrs:{"game-phase":this.gamePhase,"round-of":this.gamePhase.roundOf,"round-state":this.gamePhase.roundState}}),t._v(" "),n("div",{staticClass:"game-bar",staticStyle:{"text-align":"left"}},[n("bag-component",{staticClass:"bag",attrs:{cards:this.gamePhase.bag.cards}}),t._v(" "),n("div",{staticClass:"pawn-container",on:{click:t.onPawnInteract}},t._l(this.myPlayer.pawns,(function(e){return n("pawn-component",{key:e,staticClass:"pawn",attrs:{"game-phase":t.gamePhase,"pawn-image":t.myPawnImage}})})),1),t._v(" "),n("div",{staticClass:"button-bar game-footer"},[n("button",{staticClass:"btn primary-btn",attrs:{disabled:!t.canNextRound()},on:{click:t.onNextRound}},[t._v("\n                Done!\n            ")])])],1),t._v(" "),n("div",{staticClass:"scoreboard",style:{display:this.gamePhase.isScoreBoardVisible?"block":"none"}},[t.isGameEnd()?n("div",{staticClass:"end"},[n("h2",{staticClass:"winner"},[t._v("The winner is: "),n("span",{style:{color:this.gamePhase.winner.details.color}},[t._v(t._s(this.gamePhase.winner.details.username))]),t._v("!")]),t._v(" "),n("h6",{staticClass:"description"},[t._v("Congrats! ^^")]),t._v(" "),n("br"),t._v(" "),n("h6",{staticClass:"countdown"},[t._v("Returning to lobby in: "+t._s(this.gamePhase.lobbyCountdown)+" seconds.")])]):t._e(),t._v(" "),n("table",[t._m(0),t._v(" "),t._l(this.gamePhase.getScoreBoard(),(function(e,i){return n("tr",[n("th",{style:t.getRankColor(i+1)},[t._v("\n                    "+t._s(i+1)+".\n                ")]),t._v(" "),n("td",{staticClass:"username"},[t._v("\n                    "+t._s(e.username)+"\n                ")]),t._v(" "),n("td",[t._v(t._s(e.score))])])}))],2)])],1)};ft._withStripped=!0;var vt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"player-bar"},t._l(t.players,(function(e){return n("div",{staticClass:"player",style:e.isMyRound()?{backgroundColor:"rgba(255, 255, 0, 0.25)"}:{backgroundColor:"rgba(0, 0, 0, 0.25)"}},[n("avatar-component",{staticClass:"avatar",attrs:{avatarId:e.details.avatar,color:e.details.color}}),t._v(" "),n("div",[n("div",{staticClass:"name",style:{textDecoration:e.online?"none":"line-through"}},[t._v("\n                "+t._s(e.username)+"\n            ")]),t._v(" "),n("div",{staticClass:"score"},[t._v("\n                "+t._s(e.score)+"\n            ")]),t._v(" "),n("div",[0===e.pawns?n("div",{staticClass:"pawn"},[t._v("\n                    \n                ")]):t._e(),t._v(" "),t._l(e.pawns,(function(t){return n("div",{key:t,staticClass:"pawn"},[n("svg",{attrs:{height:"14",width:"14"}},[n("circle",{attrs:{cx:"7",cy:"7",r:"6",stroke:"black","stroke-width":"1",fill:"#"+("00000"+(0|e.color).toString(16)).substr(-6)}})])])}))],2)])],1)})),0)};vt._withStripped=!0;var wt=function(){var t=this.$createElement;return(this._self._c||t)("div",{style:this.getImageStyle(),on:{click:this.onClick}})};wt._withStripped=!0;var yt=function(){var t=this.$createElement,e=this._self._c||t;return e("div",{style:this.getImageStyle()},[e("div",{style:this.getOverlayStyle()})])};yt._withStripped=!0;var bt=i.a.extend({props:["frame","atlasUrl","atlasSize","tint"],methods:{getImageStyleAdjustment(){return{position:{x:this.frame.x/(this.atlasSize.width-this.frame.width+Number.EPSILON)*100,y:this.frame.y/(this.atlasSize.height-this.frame.height+Number.EPSILON)*100},size:{x:this.atlasSize.width/this.frame.width*100,y:this.atlasSize.height/this.frame.height*100}}},getImageStyle(){const t=this.getImageStyleAdjustment();return{backgroundImage:`url(${this.atlasUrl})`,backgroundPosition:`${t.position.x}% ${t.position.y}%`,backgroundSize:`${t.size.x}% ${t.size.y}%`}},getOverlayStyle(){const t=this.getImageStyleAdjustment();return{width:"100%",height:"100%",maskImage:`url(${this.atlasUrl})`,webkitMaskImage:`url(${this.atlasUrl})`,maskPosition:`${t.position.x}% ${t.position.y}%`,webkitMaskPosition:`${t.position.x}% ${t.position.y}%`,maskSize:`${t.size.x}% ${t.size.y}%`,webkitMaskSize:`${t.size.x}% ${t.size.y}%`,backgroundColor:""+this.tint,mixBlendMode:"multiply"}}}}),xt=Object(l.a)(bt,yt,[],!1,null,"63104584",null);xt.options.__file="src/app/ui/util/sprite.vue";var St=xt.exports,_t=i.a.extend({props:["pawnImage"],methods:{colorToStr:t=>`\n                rgb(\n                    ${t>>16&255},\n                    ${t>>8&255},\n                    ${255&t}\n                )\n            `,onClick(){this.eventEmitter.emit("pawn-pick",this)},getImageStyle(){return{backgroundImage:`url(${this.pawnImage})`,backgroundSize:"100%"}}},components:{SpriteComponent:St}}),Ct=Object(l.a)(_t,wt,[],!1,null,"b4c6485e",null);Ct.options.__file="src/app/ui/game/pawn.vue";var Pt=Ct.exports,Et=i.a.extend({props:["players","roundOf"],components:{AvatarComponent:_,PawnComponent:Pt}}),kt=(n(62),Object(l.a)(Et,vt,[],!1,null,"4ed698f9",null));kt.options.__file="src/app/ui/game/playerBar.vue";var It=kt.exports,Tt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("sprite-component",{staticClass:"bag-sprite",attrs:{frame:this.frame,"atlas-url":this.getAtlasUrl(),"atlas-size":this.getAtlasSize(),tint:"transparent"},nativeOn:{mouseover:function(e){return t.onOver(e)},click:function(e){return t.onClick(e)},mouseleave:function(e){return t.onLeave(e)}}}),t._v(" "),n("div",{staticClass:"bag-text"},[t._v("\n        "+t._s(this.cards.length)+"\n    ")])],1)};Tt._withStripped=!0;var zt=n.p+"24af530225116ed6603bda2d50eb3f60.png",Ot=i.a.extend({props:["cards"],data:()=>({frame:""}),methods:{getAtlas:()=>y.f.shared.resources.bag.spritesheet,getAtlasUrl:()=>zt,getAtlasSize(){return this.getAtlas().baseTexture},getBagOpened(){return this.getAtlas().textures["bag_opened.png"].orig},getBagClosed(){return this.getAtlas().textures["bag_closed.png"].orig},onOver(){this.eventEmitter.emit("bag-over",this)},onClick(){this.eventEmitter.emit("bag-click",this)},onLeave(){this.eventEmitter.emit("bag-leave",this)}},components:{SpriteComponent:St},mounted(){this.frame=this.getBagClosed()}}),Rt=(n(64),Object(l.a)(Ot,Tt,[],!1,null,"514f47cf",null));Rt.options.__file="src/app/ui/game/bag.vue";var Mt=Rt.exports,At=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"hint"},[void 0===t.roundOf?n("div"):t.gamePhase.isMyRound()?n("div",{staticClass:"my-round"},[t.roundState===t.RoundState.CardDraw?n("div",{staticClass:"card-draw"},[t._v("\n            Yo! It's your turn, "),n("u",[t._v("draw a card")]),t._v(".\n        ")]):t._e(),t._v(" "),t.roundState===t.RoundState.CardPlace?n("div",{staticClass:"card-place"},[n("u",[t._v("Place the card")]),t._v(" on the board.\n        ")]):t._e(),t._v(" "),t.roundState===t.RoundState.PawnPick?n("div",{staticClass:"pawn-pick"},[n("u",[t._v("Skip")]),t._v(" the round or "),n("u",[t._v("pick a pawn")]),t._v(".\n        ")]):t._e(),t._v(" "),t.roundState===t.RoundState.PawnPlace?n("div",{staticClass:"pawn-place"},[n("u",[t._v("Place the pawn")]),t._v(" within the card you've placed.\n        ")]):t._e()]):n("div",{staticClass:"other-round"},[t.roundOf.online?n("div",{staticClass:"online"},[t._v("\n            It's the turn of: "),n("span",{style:{color:"#"+("00000"+(0|t.roundOf.color).toString(16)).substr(-6)}},[t._v(t._s(t.roundOf.username))]),t._v(".\n        ")]):n("div",{staticClass:"offline"},[t._v("\n            Trying to contact "),n("span",{style:{color:"#"+("00000"+(0|t.roundOf.color).toString(16)).substr(-6)}},[t._v(t._s(t.roundOf.username))]),t._v("...\n        ")])])])};At._withStripped=!0;var Bt=i.a.extend({props:["gamePhase","roundOf","roundState"],data:()=>({RoundState:te})}),Dt=(n(66),Object(l.a)(Bt,At,[],!1,null,"8a8a835a",null));Dt.options.__file="src/app/ui/game/hintBar.vue";var Lt=Dt.exports,$t=n.p+"a855f2851c0ed1548867501fe2686f89.png",Ft=y.o.hex2rgb,Nt=i.a.extend({components:{PlayerBarComponent:It,BagComponent:Mt,PawnComponent:Pt,HintBarComponent:Lt},mounted:function(){this.recomputePawnImage()},methods:{onPawnInteract(t){this.eventEmitter.emit("pawn-interact",t)},canNextRound(){return this.gamePhase.isMyRound()&&this.gamePhase.canSkipRound()},onNextRound(){this.eventEmitter.emit("next-round")},colorToStr:t=>`\n                rgb(\n                    ${t>>16&255},\n                    ${t>>8&255},\n                    ${255&t}\n                )\n            `,getRankColor(t){switch(t){case 1:return{color:"#fdd835"};case 2:return{color:"#bdbdbd"};case 3:return{color:"#a30000"};default:return{color:"white"}}},isGameEnd(){return this.gamePhase.roundState===te.GameEnd},recomputePawnImage(){let t=new Image;t.src=$t;let e=()=>{let e=document.createElement("canvas");e.style.display="none";let n=this.myPlayer.details.color,i=y.f.shared.resources.pawns.spritesheet,a=i.baseTexture;const s="pawn_"+this.myPlayer.details.avatar+".png",r=i.textures[s].orig;e.width=r.width,e.height=r.height;let o=e.getContext("2d");o.globalCompositeOperation="copy",o.drawImage(t,r.x,r.y,a.width,a.height,0,0,a.width,a.height);const l=Ft(n),h=l[0],d=l[1],c=l[2],p=o.getImageData(0,0,a.width,a.height);let u=p.data;for(let t=0;t<u.length;t+=4)u[t+0]*=h,u[t+1]*=d,u[t+2]*=c;o.putImageData(p,0,0),console.log(e.toDataURL()),this.myPawnImage=e.toDataURL()};t.complete?e():t.onload=e}}}),Ut=(n(68),Object(l.a)(Nt,ft,[function(){var t=this.$createElement,e=this._self._c||t;return e("tr",[e("th",[this._v("Rank")]),this._v(" "),e("th",[this._v("Player")]),this._v(" "),e("th",[this._v("Score")])])}],!1,null,"25ba038a",null));Ut.options.__file="src/app/ui/game/game.vue";var jt=Ut.exports;class Yt{constructor(t,e){this.score=0,this.pawns=5,this.pendingPawns=0,this.online=!0,this.phase=t,this.details=e}get id(){return this.details.id}get username(){return this.details.username}get color(){return this.details.color}get avatar(){return this.details.avatar}isMyRound(){return this.phase.isRoundOf(this)}createPawn(){const t=y.f.shared.resources.pawns.spritesheet.textures["pawn_"+this.avatar+".png"],e=new y.j(t);return e.width=28,e.height=70,e.anchor.set(.5,1),e.tint=this.color,e}}class qt{constructor(t){this.animations=new Map,this.orderedPlayers=t}playerIdToIndex(t){let e=0;for(let n of this.orderedPlayers){if(n.id===t)return e;e++}return-1}enable(){this.playerBar=window.document.getElementsByClassName("player-bar")[0],void 0===this.playerBar&&console.error("Cannot find player bar, disabling score viewer")}disable(){this.playerBar=void 0}animateScore(t,e,n,i){let a=this.playerIdToIndex(t),s=this.animations.get(a);if(void 0!==s)return void s.addScore(e);let r=this.createParticle(a,e,i);this.animations.set(a,r),r.display.zIndex=50,n.addChild(r.display)}createParticle(t,e,n){let i,a;if(void 0!==this.playerBar){let e=this.playerBar.children[t].getBoundingClientRect();i=e.bottom,a=(e.left+e.right)/2}else i=0,a=fe.view.width/2;return new Gt(this,t,a,i,e,n)}}class Gt{constructor(t,e,n,i,a,s){this.parent=t,this.playerIndex=e,this.score=a,this.x=n,this.endY=i,this.life=0,this.lifetime=Gt.LIFETIME*s;let r=new y.l("+"+a.toString(),{fontSize:24,fill:182486,align:"center"});r.anchor.set(.5,0),this.display=r,this.update(),fe.ticker.add(this.onTick,this)}addScore(t){this.score+=t,this.display.text="+"+this.score.toString(),this.life=0}update(){if(this.life>this.lifetime)return fe.ticker.remove(this.onTick,this),this.display.parent.removeChild(this.display),void this.parent.animations.delete(this.playerIndex);let t=this.life/this.lifetime;this.display.position.set(this.x,this.endY+(1-t)*Gt.TRAVEL_H),this.display.alpha=1-t}onTick(t){this.life+=t,this.update()}}Gt.LIFETIME=40,Gt.TRAVEL_H=20;class Ht{constructor(t){this.phase=t,this.graphics=new y.e}enable(t){this.draw(t),this.phase.board.addChild(this.graphics)}disable(){this.graphics.parent&&this.graphics.parent.removeChild(this.graphics)}draw(t){let e=this.phase.board,n=this.graphics,i=new y.h,a=new Set;n.clear();for(let s of t){let t=e.flatIndex(s.x,s.y);a.has(t)||(a.add(t),this.phase.board.cardCoordToRelPos(s.x,s.y,i),n.beginFill(5592575,.25),n.drawRect(i.x-gt.TILE_SIZE/2,i.y-gt.TILE_SIZE/2,gt.TILE_SIZE,gt.TILE_SIZE),n.endFill())}n.zIndex=-100}}class Xt extends y.d{constructor(t,e){super(),this.sideOverlay=[],this.par=t,this.phase=e,this.initPixi()}createTriangle(t,e,n,i){const a=new y.e;a.beginFill(e),a.moveTo(t[0].x,t[0].y);for(let e=0;e<t.length;e++){const n=t[(e+1)%3];a.lineTo(n.x,n.y)}return a.endFill(),a.alpha=n,i&&(a.hitArea=new y.i(t),a.interactive=i),a}createSidePlacer(t,e,n){const i=e/2;let a;switch(t){case K.TOP:a=[new y.h(0,0),new y.h(i,i),new y.h(e,0)];break;case K.BOTTOM:a=[new y.h(0,e),new y.h(i,i),new y.h(e,e)];break;case K.LEFT:a=[new y.h(0,0),new y.h(i,i),new y.h(0,e)];break;case K.RIGHT:a=[new y.h(e,0),new y.h(i,i),new y.h(e,e)]}const s=this.createTriangle(a,n,.5,!0);return s.on("mouseover",()=>{this.phase.isMyRound()&&(s.alpha=.7)}).on("mouseout",()=>{s.alpha=.5}),s.getEmplacement=()=>{const t=new y.h;for(let e=0;e<3;e++)t.x+=a[e].x,t.y+=a[e].y;return t.x/=3,t.y/=3,t.x+=this.position.x-e/2,t.y+=this.position.y-e/2,t},s}createPennantPlacer(t,e){const n=t/2,i=t/2,a=t/3,s=new y.e;return s.beginFill(e),s.drawCircle(n,i,a),s.endFill(),s.alpha=.5,s.interactive=!0,s.hitArea=new y.c(n,i,a),s.on("mouseover",()=>{this.phase.isMyRound()&&(s.alpha=.7)}).on("mouseout",()=>{s.alpha=.5}),s.getEmplacement=()=>this.position,s}initPixi(){for(let t=0;t<4;t++){const e=this.createSidePlacer(t,gt.TILE_SIZE,[16711680,65280,255,16776960][t]);e.zIndex=0,this.addChild(e),this.sideOverlay[t]=e}const t=this.createPennantPlacer(gt.TILE_SIZE,16777215);t.zIndex=1,t.interactiveChildren=!1,this.addChild(t),this.monasteryOverlay=t,this.pivot.set(gt.TILE_SIZE/2,gt.TILE_SIZE/2)}serveTo(t,e){this.phase.board.cardCoordToRelPos(t.x,t.y,this.position);let n=this.phase.board.cardConnector;for(let i=0;i<4;i++)this.removeChild(this.sideOverlay[i]),n.canOwnPath(t.x,t.y,i)&&(this.addChild(this.sideOverlay[i]),this.sideOverlay[i].off("pointerdown").on("pointerdown",()=>{this.phase.isMyRound()&&this.placeSide(e,t,this.sideOverlay[i].getEmplacement(),i)}));this.removeChild(this.monasteryOverlay),t.tile.card.flags.indexOf("monastery")>=0&&(this.addChild(this.monasteryOverlay),this.monasteryOverlay.off("pointerdown").on("pointerdown",()=>{this.phase.isMyRound()&&this.placeMonastery(e,t,this.monasteryOverlay.getEmplacement())}))}placeSide(t,e,n,i){let a=this.phase.board.cardConnector;this.sendPacket(i,n),a.ownPath(e.x,e.y,i,t)?this.par.onPawnPlace(n):console.error("Error placing pawn at side, path already owned")}placeMonastery(t,e,n){let i=e.tile.monasteryData;this.sendPacket("monastery",n),i.setPawn(t)?this.par.onPawnPlace(n):console.error("Error placing pawn at monastery, already owned")}sendPacket(t,e){this.phase.isMyRound()&&ve.send({type:"player_pawn_place",side:t,pos:{x:e.x,y:e.y}})}}class Zt{constructor(t,e,n){this.used=!1,this.pending=!1,this.points=0,this.phase=t,this.owner=e,this.display=n}addScore(t){this.points+=t}setPending(){this.pending||(this.pending=!0,this.owner.pendingPawns++)}returnToPlayer(t){if(this.used)return!1;this.used=!0,this.points>0&&this.phase.awardScore(this.owner.id,this.points,t),this.display.parent.removeChild(this.display),this.display=void 0,this.owner.pawns++,this.pending&&this.owner.pendingPawns--}static createFor(t,e,n,i){let a=t.playersById.get(e);if(a.pawns<=0)return;a.pawns--;let s=a.createPawn();return s.position.set(n,i),s.zIndex=10001,t.board.addChild(s),new Zt(t,a,s)}setPosition(t,e){this.used||this.display.position.set(t,e)}getPosition(){if(!this.used)return this.display.position}}class Wt{constructor(t){this.phase=t,this.placer=new Xt(this,t),this.previewServer=new Vt,this.previewClient=new Jt(this,t)}onPawnInteract(t){if(!this.phase.isMyRound())return;let e=this.phase.roundState;if(e==te.PawnPlace)this.undoPawnPick();else if(e==te.PawnPick){let e=new y.h(t.clientX,t.clientY);this.phase.board.worldTransform.applyInverse(e,e),this.pawnPick(e.x,e.y)}}onPawnMove(t){if(this.phase.me.isMyRound()&&void 0!==this.pawn){const e=t.data.getLocalPosition(this.phase.board,null,t.data.global);this.pawn.setPosition(e.x,e.y),this.previewServer.onUpdate(e.x,e.y)}}undoPawnPick(){void 0!==this.pawn&&(this.pawn.returnToPlayer(1),this.pawn=void 0,this.phase.board.removeChild(this.placer),this.phase.roundState=te.PawnPick,this.phase.isMyRound()&&(this.previewServer.cancel(),ve.send({type:"player_pawn_interact",pickUp:!1})))}pawnPick(t,e){return this.createPawn(this.phase.roundOf.id,t,e),void 0!==this.pawn&&(this.phase.roundState=te.PawnPlace,this.placer.serveTo(this.phase.placedCard,this.pawn),this.placer.zIndex=1e4,this.phase.board.addChild(this.placer),this.phase.isMyRound()&&ve.send({type:"player_pawn_interact",pickUp:!0,x:t,y:e}),!0)}createPawn(t,e,n){this.pawn=Zt.createFor(this.phase,t,e,n)}onPlacePacket(t){if(!this.phase.playersById.get(t.sender).isMyRound())return void console.error("Wrong message sender");void 0===this.previewClient.pawn&&this.createPawn(t.sender,t.pos.x,t.pos.y);let e=new y.h(t.pos.x,t.pos.y);"monastery"==t.side?this.placer.placeMonastery(this.pawn,this.phase.placedCard,e):this.placer.placeSide(this.pawn,this.phase.placedCard,e,t.side)}onPawnPlace(t){this.pawn.setPosition(t.x,t.y),this.pawn=void 0,this.phase.board.removeChild(this.placer),this.previewClient.onPlace(),this.previewServer.cancel(),this.phase.nextRound()}enable(){this.previewClient.enable(),ve.eventEmitter.on("player_pawn_place",this.onPlacePacket,this),this.phase.uiEventEmitter.on("pawn-interact",this.onPawnInteract,this)}disable(){this.previewClient.disable(),ve.eventEmitter.off("player_pawn_place",this.onPlacePacket,this),this.phase.uiEventEmitter.off("pawn-interact",this.onPawnInteract,this)}}class Vt{constructor(){this.lastX=0,this.lastY=0,this.nextX=0,this.nextY=0}onUpdate(t,e){this.nextX=t,this.nextY=e,this.trySend()}cancel(){clearTimeout(this.timeoutId),this.timeoutId=void 0}startTimer(){this.timeoutId=setTimeout(this.onTimerEnd.bind(this),50)}onTimerEnd(){this.timeoutId=void 0,this.trySend()}trySend(){void 0===this.timeoutId&&(this.lastX===this.nextX&&this.lastY===this.nextY||(ve.send({type:"player_pawn_preview",x:this.nextX,y:this.nextY}),this.lastX=this.nextX,this.lastY=this.nextY,this.startTimer()))}}class Jt{constructor(t,e){this.pawn=void 0,this.lastX=0,this.lastY=0,this.nextX=0,this.nextY=0,this.receiveTime=0,this.parent=t,this.phase=e}onPlace(){this.pawn=void 0,this.receiveTime=0,fe.ticker.remove(this.onTick,this)}onPreviewPacket(t){if(this.phase.playersById.get(t.sender).isMyRound()){if(0==this.receiveTime)this.pawn.setPosition(t.x,t.y),this.lastX=t.x,this.lastY=t.y;else{let t=this.pawn.getPosition();this.lastX=t.x,this.lastY=t.y}this.receiveTime=Date.now(),this.nextX=t.x,this.nextY=t.y}else console.error("Wrong sender")}onInteractPacket(t){if(!this.phase.playersById.get(t.sender).isMyRound())return void console.error("Wrong sender");let e=void 0!==this.pawn;if(t.pickUp!=e)if(t.pickUp){if(this.phase.roundState!==te.PawnPick)return void console.error("Invalid round state");this.parent.pawnPick(t.x,t.y),this.pawn=this.parent.pawn,fe.ticker.add(this.onTick,this)}else{if(this.phase.roundState!==te.PawnPlace)return void console.error("Invalid round state");this.onPlace(),this.parent.undoPawnPick(),fe.ticker.remove(this.onTick,this)}}onTick(){let t=Date.now(),e=Math.min((t-this.receiveTime)/50,1),n=this.lastX*(1-e)+this.nextX*e,i=this.lastY*(1-e)+this.nextY*e;this.pawn.setPosition(n,i)}enable(){ve.eventEmitter.on("player_pawn_preview",this.onPreviewPacket,this),ve.eventEmitter.on("player_pawn_interact",this.onInteractPacket,this)}disable(){ve.eventEmitter.off("player_pawn_preview",this.onPreviewPacket,this),ve.eventEmitter.off("player_pawn_interact",this.onInteractPacket,this)}}class Kt{constructor(){this.lastX=0,this.lastY=0,this.lastRot=0,this.nextX=0,this.nextY=0,this.nextRot=0}onUpdate(t,e,n){this.nextX=t,this.nextY=e,this.nextRot=n,this.trySend()}onPlace(){clearTimeout(this.timeoutId),this.timeoutId=void 0}startTimer(){this.timeoutId=setTimeout(this.onTimerEnd.bind(this),Kt.PACKET_UPDATE_FREQ)}onTimerEnd(){this.timeoutId=void 0,this.trySend()}trySend(){void 0===this.timeoutId&&(this.lastX===this.nextX&&this.lastY===this.nextY&&this.lastRot===this.nextRot||(ve.send({type:"player_place_card_preview",x:this.nextX,y:this.nextY,rotation:this.nextRot}),this.lastX=this.nextX,this.lastY=this.nextY,this.lastRot=this.nextRot,this.startTimer()))}}Kt.PACKET_UPDATE_FREQ=75;class Qt extends s{constructor(t,e,n){super("game"),this.playersById=new Map,this.orderedPlayers=[],this.roundOfIdx=-1,this.roundOf=void 0,this.roundState=te.CardDraw,this.roomId=t,Object.keys(n).map(t=>{const i=new Yt(this,n[t]);i.id===e.id&&(this.me=i),this.playersById.set(i.id,i)}),this.orderedPlayers=Array.from(this.playersById.values()).sort((t,e)=>t.id<e.id?-1:t.id>e.id?1:0),this.pawnManager=new Wt(this),this.pathAnimationScheduler=new ot(this),this.drawnCardPreview=new Kt;let i=this.setupBag();this.setupBoard(i),this.scoreVisualizer=new qt(this.orderedPlayers),this.cardPlaceAssistant=new Ht(this)}ui(){const t=this;return new jt({data:()=>({gamePhase:t,myPlayer:t.me,players:t.orderedPlayers,roundState:t.roundState,showScoreBoard:!1,myPawnImage:""})})}setupBag(){return this.bag=et.fromModality(this),this.bag.draw()}setupBoard(t){this.board=new gt(this,this.bag,t),this.board.position.set(0,0),this.centerBoard()}setSeed(t){this.seed=t,console.log("Game seed:",this.seed),mt(this.orderedPlayers,this.seed),mt(this.bag.cards,this.seed),this.onStart()}onRandomSeed(t){this.seed?console.error("Seed received but there was already another seed set."):this.setSeed(t.seed)}onPlayerLeft(t){const e=this.playersById.get(t.player);e.online=!1,void 0!==this.roundOf&&this.roundOf.id===e.id&&this.nextRound(),void 0!==t.newHost&&(this.playersById.get(t.newHost).details.isHost=!0,t.newHost!=this.me.id||this.seed||this.generateSeed()),this.vue.$forceUpdate()}onStart(){console.log("Game started."),this.nextRound()}isMyRound(){return this.isRoundOf(this.me)}isRoundOf(t){return this.roundOf&&this.roundOf.id==t.id}canSkipRound(){switch(this.roundState){case te.CardDraw:case te.CardPlace:return!1;case te.PawnPick:case te.PawnPlace:return!0}}canPlacePawn(){if(this.canSkipRound())return!(this.roundOf.pawns+this.roundOf.pendingPawns<=0)&&(void 0!==this.placedCard.tile.monasteryData||this.board.cardConnector.canOwnAnyPath(this.placedCard.x,this.placedCard.y))}hasDrawn(){return void 0!==this.drawnCard}hasPlaced(){return void 0!==this.placedCard}onNextRoundClick(){this.isMyRound()&&this.canSkipRound()&&(this.pawnManager.undoPawnPick(),ve.send({type:"next_round"}),this.nextRound())}nextRound(){let t=0!=this.bag.size();void 0!==this.placedCard&&this.board.onRoundEnd(this.placedCard.x,this.placedCard.y,!t),this.drawnCard=void 0,this.placedCard=void 0,t?(this.roundOfIdx=(this.roundOfIdx+1)%this.orderedPlayers.length,this.roundOf=this.orderedPlayers[this.roundOfIdx],this.roundOf.online?(console.log("Round of:",this.roundOf.username),this.roundState=te.CardDraw,this.isMyRound()&&console.log("It's your round!"),this.vue.$forceUpdate()):setTimeout(()=>{this.nextRound()},5e3)):this.onEnd()}onDraw(){let t,e;this.isMyRound()&&ve.send({type:"player_draw"});do{if(t=this.bag.draw(),void 0===t)return void this.onEnd();e=this.board.getPossiblePlacements(t)}while(0==e.length);this.roundState=te.CardPlace,this.drawnCard=new it(t),this.drawnCardSprite=this.drawnCard.createSprite(),this.drawnCardSprite.anchor.set(.5,.5),this.drawnCardSprite.width=gt.TILE_SIZE,this.drawnCardSprite.height=gt.TILE_SIZE,this.board.addChild(this.drawnCardSprite),this.cardPlaceAssistant.enable(e)}onPlayerDraw(t){this.onDraw()}onMouseWheel(t){const e=1-.1*Math.sign(t.deltaY);if(this.board.scale.x<.1&&e<1||this.board.scale.x>3&&e>1)return;let n=this.board.position.x-t.clientX,i=this.board.position.y-t.clientY;n*=e,i*=e;const a=new y.h(n+t.clientX,i+t.clientY),s=new y.h(this.board.scale.x*e,this.board.scale.y*e);this.board.isBoardLost(a,s)||(this.board.position.copyFrom(a),this.board.scale.copyFrom(s))}onCursorMove(t){this.isMyRound()&&(this.drawnCardSprite&&this.updateDrawnCardWithMouse(t),this.roundState==te.PawnPlace&&this.pawnManager.onPawnMove(t))}onCursorDown(t){this.lastMouseDownTime=Date.now(),this.lastMouseDownPos=t.data.global.clone()}onCursorUp(t){if(void 0===this.lastMouseDownTime)return;let e=Date.now()-this.lastMouseDownTime,n=Math.abs(t.data.global.x-this.lastMouseDownPos.x),i=Math.abs(t.data.global.y-this.lastMouseDownPos.y);Math.sqrt(n*n+i*i)<5&&e<500&&this.onCursorClick(t)}onCursorClick(t){if(this.drawnCard&&this.isMyRound()){let e=t.data.getLocalPosition(this.board,null,t.data.global);this.board.containerCoordsToTileCoords(e,e),this.onTryPlace(e.x,e.y)}}onCursorRightClick(t){this.drawnCard&&this.isMyRound()&&(this.drawnCard.rotation=(this.drawnCard.rotation+1)%4,this.updateDrawnCardWithMouse(t))}updateDrawnCardWithMouse(t){let e=t.data.getLocalPosition(this.board,null,t.data.global);this.board.containerCoordsToTileCoords(e,e),this.drawnCardPreview.onUpdate(e.x,e.y,this.drawnCard.rotation),this.updateDrawnCard(e.x,e.y)}updateDrawnCard(t,e){let n=this.board.canSet(t,e,this.drawnCard),i=new y.h;this.board.cardCoordToRelPos(t,e,i),this.drawnCardSprite.position.set(i.x,i.y),this.drawnCardSprite.tint=n?16777215:16755370,this.drawnCardSprite.rotation=-this.drawnCard.rotation*Math.PI/2}onPlace(t,e,n){return this.drawnCard.rotation=n,!!this.board.set(t,e,this.drawnCard)&&(this.cardPlaceAssistant.disable(),this.roundState=te.PawnPick,this.board.removeChild(this.drawnCardSprite),this.placedCard={x:t,y:e,tile:this.drawnCard},this.drawnCard=void 0,this.drawnCardSprite=void 0,this.isMyRound()&&ve.send({type:"player_place_card",x:t,y:e,rotation:n}),this.canPlacePawn()?this.vue.$forceUpdate():this.nextRound(),!0)}onTryPlace(t,e){if(!this.drawnCard||!this.isMyRound())return!1;let n=this.drawnCard.rotation;return this.onPlace(t,e,n)}onPlayerPlaceCard(t){this.playersById.get(t.sender).isMyRound()?this.onPlace(t.x,t.y,t.rotation)||console.error("Invalid tile set!"):console.error("Wrong message sender")}onPlayerPlaceCardPreview(t){this.playersById.get(t.sender).isMyRound()?(this.drawnCard.rotation=t.rotation,this.updateDrawnCard(t.x,t.y)):console.error("Wrong message sender")}onNextRoundPacket(t){this.playersById.get(t.sender).isMyRound()?this.canSkipRound()?this.nextRound():console.error("Invalid round state: "+this.roundState):console.error("Wrong message sender")}onEndGamePacket(t){this.playersById.get(t.sender).details.isHost?this.moveToNextStage():console.warn("Player "+t.sender+" tried to end the game")}onConnectionClose(t){if(void 0===this.playersById.get(t.getId()))return;let e={type:"event_player_left",player:t.getId()};this.onPlayerLeft(e)}moveToNextStage(){const t=Array.from(this.playersById.values(),t=>t.details);we.setPhase(new ne(this.roomId,this.me.details,t))}centerBoard(){let t=fe.renderer.width/2,e=fe.renderer.height/2,n=this.board.gridSide*gt.TILE_SIZE;this.board.position.set(t-n/2,e-n/2)}awardScore(t,e,n){this.playersById.get(t).score+=e,this.scoreVisualizer.animateScore(t,e,fe.stage,n)}getScoreBoard(){return Object.assign([],this.orderedPlayers).sort((t,e)=>e.score-t.score)}setScoreBoardVisible(t){this.isScoreBoardVisible=t,this.vue.$forceUpdate()}onScoreBoardKeyDown(t){this.roundState!==te.GameEnd&&"Tab"===t.key&&(this.setScoreBoardVisible(!0),t.preventDefault())}onScoreBoardKeyUp(t){this.roundState!==te.GameEnd&&"Tab"===t.key&&this.setScoreBoardVisible(!1)}onEnd(){this.roundState=te.GameEnd,this.board.cardConnector.onGameEnd(),this.board.onGameEnd();let t=()=>{this.winner=this.getScoreBoard()[0],this.vue.$forceUpdate(),this.setScoreBoardVisible(!0),this.lobbyCountdown=20;let t=setInterval(()=>{--this.lobbyCountdown<=0&&(clearInterval(t),this.me.details.isHost&&(ve.send({type:"end_game"}),this.moveToNextStage())),this.vue.$forceUpdate()},1e3)};this.pathAnimationScheduler.isRunning?this.pathAnimationScheduler.onQueueEmpty=t:t()}generateSeed(){this.setSeed(Math.random()),ve.send({type:"random_seed",seed:this.seed})}applyCanvasStyle(t){const e=t.style;e.position="fixed",e.width="100%",e.height="100%"}enable(){super.enable();const t=fe.view;this.applyCanvasStyle(t),document.body.appendChild(t),fe.stage=new y.d,fe.stage.addChild(this.board),fe.stage.interactive=!0,this.me.details.isHost&&this.generateSeed(),this.bag.listen(),this.scoreVisualizer.enable(),this.pawnManager.enable(),ve.eventEmitter.on("random_seed",this.onRandomSeed,this),ve.eventEmitter.on("player_draw",this.onPlayerDraw,this),ve.eventEmitter.on("player_place_card",this.onPlayerPlaceCard,this),ve.eventEmitter.on("player_place_card_preview",this.onPlayerPlaceCardPreview,this),ve.eventEmitter.on("special_player_left",this.onPlayerLeft,this),ve.eventEmitter.on("next_round",this.onNextRoundPacket,this),ve.eventEmitter.on("end_game",this.onEndGamePacket,this),ve.isMaster&&ve.eventEmitter.on("#connection_close",this.onConnectionClose,this),fe.stage.on("mousemove",this.onCursorMove,this),fe.stage.on("mousedown",this.onCursorDown,this),fe.stage.on("mouseup",this.onCursorUp,this),fe.stage.on("rightdown",this.onCursorRightClick,this),me.on("wheel",this.onMouseWheel,this),me.on("keydown",this.onScoreBoardKeyDown,this),me.on("keyup",this.onScoreBoardKeyUp,this),this.uiEventEmitter.on("next-round",this.onNextRoundClick,this)}disable(){super.disable(),fe.stage.off("mousemove",this.onCursorMove,this),fe.stage.off("mousedown",this.onCursorDown,this),fe.stage.off("mouseup",this.onCursorUp,this),fe.stage.off("rightdown",this.onCursorRightClick,this),this.pawnManager.disable(),this.scoreVisualizer.disable(),this.bag.unlisten(),ve.eventEmitter.off("random_seed",this.onRandomSeed,this),ve.eventEmitter.off("player_draw",this.onPlayerDraw,this),ve.eventEmitter.off("player_place_card",this.onPlayerPlaceCard,this),ve.eventEmitter.off("player_place_card_preview",this.onPlayerPlaceCardPreview,this),ve.eventEmitter.off("special_player_left",this.onPlayerLeft,this),ve.eventEmitter.off("next_round",this.onNextRoundPacket,this),ve.eventEmitter.off("end_game",this.onEndGamePacket,this),ve.isMaster&&ve.eventEmitter.off("#connection_close",this.onConnectionClose,this),me.off("wheel",this.onMouseWheel,this),me.off("keydown",this.onScoreBoardKeyDown,this),me.off("keyup",this.onScoreBoardKeyUp,this),this.uiEventEmitter.off("next-round",this.onNextRoundClick,this),document.body.removeChild(fe.view)}}var te;!function(t){t[t.CardDraw=0]="CardDraw",t[t.CardPlace=1]="CardPlace",t[t.PawnPick=2]="PawnPick",t[t.PawnPlace=3]="PawnPlace",t[t.GameEnd=4]="GameEnd"}(te||(te={}));class ee extends s{constructor(t,e,n){super("roomStart"),this.readySet=new Set,this.playerCount=0,this.roomId=t,this.me=e,this.playersById=n}enable(){if(super.enable(),ve.isMaster){ve.rejectNewcomers=!0;for(let t of ve.connections)t.getId()in this.playersById||(console.log("Kicking: "+t.getId()),t.close());this.playerCount=-1;for(let t in this.playersById)this.playerCount+=1;ve.eventEmitter.on("event_room_start_ack",this.roomStartAck,this),ve.send({type:"event_room_start_req"})}else ve.eventEmitter.on("event_room_start_confirm",this.moveOn,this),ve.send({type:"event_room_start_ack"})}disable(){super.disable(),ve.isMaster?ve.eventEmitter.off("event_room_start_ack",this.roomStartAck,this):ve.eventEmitter.off("event_room_start_confirm",this.moveOn,this)}roomStartAck(t,e){this.readySet.has(e)||(this.readySet.add(e),console.log(this.readySet.size+"/"+this.playerCount),this.readySet.size===this.playerCount&&(ve.send({type:"event_room_start_confirm"}),ve.enableForwarding=!0,this.moveOn()))}moveOn(){we.setPhase(new Qt(this.roomId,this.me,this.playersById))}ui(){return new d}}class ne extends s{constructor(t,e,n){super("room"),this.playersById={},this.roomId=t,this.me=e,n.forEach(t=>this.addPlayer(t))}addPlayer(t){i.a.set(this.playersById,t.id,t)}removePlayer(t,e){i.a.delete(this.playersById,t),void 0!==e&&(this.playersById[e].isHost=!0,this.vue.$forceUpdate())}ui(){const t=this;return new Q({data:()=>({roomId:t.roomId,me:t.me,playersById:t.playersById})})}enable(){super.enable(),ve.rejectNewcomers=!1,ve.enableForwarding=!1,ve.eventEmitter.on("event_player_joined",this.onPlayerJoin,this),ve.eventEmitter.on("event_player_left",this.onPlayerLeft,this),ve.isMaster?(ve.eventEmitter.on("login",this.onLogin,this),ve.eventEmitter.on("#connection_close",this.onConnectionClose,this),this.uiEventEmitter.on("start",this.onStart,this)):ve.eventEmitter.on("event_room_start_req",this.onStart,this)}disable(){super.disable(),ve.eventEmitter.off("event_player_joined",this.onPlayerJoin,this),ve.eventEmitter.off("event_player_left",this.onPlayerLeft,this),ve.isMaster?(ve.eventEmitter.off("login",this.onLogin,this),ve.eventEmitter.off("#connection_close",this.onConnectionClose,this),this.uiEventEmitter.off("start",this.onStart,this)):ve.eventEmitter.off("event_room_start_req",this.onStart,this)}onPlayerJoin(t){const e=t.player;this.addPlayer(e)}onPlayerLeft(t){const e=t.player;this.removePlayer(e,t.newHost)}onLogin(t,e){if(e in this.playersById)return;t.details.isHost=!1,t.details.id=e,console.log("Adding: "+e),this.addPlayer(t.details);let n=[];for(let t in this.playersById)n.push(this.playersById[t]);ve.send({type:"login_response",requestId:t.id,result:"ok",players:n},e)}onConnectionClose(t){t.getId()in this.playersById&&this.removePlayer(t.getId())}onStart(){we.setPhase(new ee(this.roomId,this.me,this.playersById))}}class ie extends s{constructor(){super("login")}ui(){return new Z}enable(){super.enable(),this.form=this.vue.$refs.form,this.uiEventEmitter.on("submit",this.requestLogin,this)}disable(){super.disable(),this.uiEventEmitter.off("submit",this.requestLogin,this)}requestLogin(t){ve.isMaster?(t.id=ve.peer.id,t.isHost=!0,this.goToRoom([t])):(ve.eventEmitter.once("login_response",t=>{"ok"===t.result?this.goToRoom(t.players):this.form.errorMessage=t.result}),ve.send({type:"login",details:t}))}goToRoom(t){const e=window.location.hash.substr(1),n=ve.peer.id,i=t.find(t=>t.id===n);i?we.setPhase(new ne(e,i,t)):console.error("Your ID couldn't be found within the room's player list.")}}class ae{constructor(t){this.roomId="",this.connections=[],this.connectionsById=new Map,this.packetId=0,this.enableForwarding=!1,this.rejectNewcomers=!1,this.eventEmitter=new a,this.peer=new u.a(void 0,{host:"peerjs.92k.de",secure:!0,debug:2}),this.peer.on("open",this.serverConnect.bind(this)),this.peer.on("connection",this.onConnection.bind(this)),this.peer.on("error",this.serverError.bind(this)),this.isMaster=this.initConnection(t),this.roomId=this.isMaster?"":t}masterReset(){this.resetToRoom(this.peer.id,!0)}resetToRoom(t,e=!1){if(this.roomId!==t||e){for(let t of this.connections)t.close();this.isMaster=this.peer.id===t,this.roomId=t,this.isMaster||new g(this.peer.connect(this.roomId),this),this.packetId=0,this.setWindowHash()}}initConnection(t){return void 0===t||(t.startsWith("p")?(this.roomId=t,!1):(console.error("Unsupported connection: "+t),!0))}serverConnect(){this.isMaster?(this.roomId=this.peer.id,this.setWindowHash()):(console.log("Initializing connection to ",this.roomId),new g(this.peer.connect(this.roomId.substr(1)),this))}setWindowHash(){history.replaceState(null,null,"#p"+this.roomId)}serverError(t){console.error("Fatal server error: ",t),alert("Fatal server error: "+t),"peer-unavailable"===t.type&&(this.masterReset(),we.setPhase(new ie))}onConnection(t){this.rejectNewcomers&&t.close(),new g(t,this)}registerConnection(t){this.connections.push(t),this.connectionsById.set(t.getId(),t),this.eventEmitter.emit("#connection_open",t)}unregisterConnection(t){const e=this.connections.indexOf(t);e<0||(this.connections.splice(e,1),this.connectionsById.delete(t.getId()),this.eventEmitter.emit("#connection_close",t))}onDataReceived(t,e){if(this.isMaster&&(t.sender=e),this.isMaster&&this.enableForwarding)for(let n of this.connections)n.getId()!==e&&n.sendData(t);this.handleMessage(t,e)}handleMessage(t,e){let n=t.type;"string"!=typeof n||n.startsWith("#")||(console.log("Read",t),this.eventEmitter.emit("any",t,e),this.eventEmitter.emit(n,t,e))}send(t,e){const n=Object.assign({id:this.packetId},t);if(this.isMaster&&(n.sender=this.peer.id),console.log("Sent",n),this.packetId++,void 0!==e)this.connectionsById.get(e).sendData(n);else for(let t of this.connections)t.sendData(n)}}var se=n(29),re=n.p+"6e969a6bfb3b0fead7338979bc1214a6.png",oe=n(30),le=n(31),he=n(32),de=function(t,e,n,i){return new(n||(n=Promise))((function(a,s){function r(t){try{l(i.next(t))}catch(t){s(t)}}function o(t){try{l(i.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?a(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,o)}l((i=i.apply(t,e||[])).next())}))},ce=y.b,pe=y.n.ImageResource;function ue(t,e,n,i){return de(this,void 0,void 0,(function*(){return new Promise((a,s)=>{console.log("[Spritesheet] Loading: "+e);const r=new Image;r.crossOrigin="anonymous",r.onload=()=>{const n=new y.m(new ce(new pe(r))),s=new y.k(n,i);t.resources[e]=new y.g(e,""),t.resources[e].spritesheet=s,s.parse(()=>{console.log("[Spritesheet] Loaded: "+e),a(s)})},r.src=n})}))}n(70);var ge=function(t,e,n,i){return new(n||(n=Promise))((function(a,s){function r(t){try{l(i.next(t))}catch(t){s(t)}}function o(t){try{l(i.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?a(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,o)}l((i=i.apply(t,e||[])).next())}))};const me=new class extends a{constructor(t){super(),this.caught=new Set,this.catcher=t}catchEvent(t){this.catcher(t,this),this.caught.add(t)}on(t,e,n){return super.on(t,e,n),this.caught.has(t)||this.catchEvent(t),this}addListener(t,e,n){return super.addListener(t,e,n),this.caught.has(t)||this.catchEvent(t),this}}((t,e)=>{window.addEventListener(t,n=>{e.emit(t,n)})});let fe,ve;const we=new class extends s{constructor(t){super(t)}setPhase(t){this.phase&&this.phase.disable(),this.phase=t,this.phase&&this.phase.enable()}disable(){super.disable(),this.setPhase(null)}}("main");!function(){ge(this,void 0,void 0,(function*(){fe=new y.a({resizeTo:window,transparent:!0}),we.setPhase(new c),fe.view.addEventListener("contextmenu",t=>{t.preventDefault()}),yield function(){return de(this,void 0,void 0,(function*(){const t=y.f.shared;yield Promise.all([ue(t,"avatars",b,se),ue(t,"cards",re,oe),ue(t,"pawns",$t,le),ue(t,"bag",zt,he)])}))}(),ve=new ae(window.location.hash.substr(1)),we.setPhase(new ie),window.onhashchange=function(t){console.log("Hash change"+t.newURL),window.location.hash?ve.resetToRoom(window.location.hash.substr(2)):ve.masterReset()}}))}()}]);